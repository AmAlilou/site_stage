<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>Stage: D:/developpement/php/www/Stage/trunk/class/DBConnector.class.php Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.1-p1 -->
<div class="tabs">
  <ul>
    <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
    <li><a href="namespaces.html"><span>Namespaces</span></a></li>
    <li><a href="annotated.html"><span>Classes</span></a></li>
    <li id="current"><a href="files.html"><span>Files</span></a></li>
    <li>
      <form action="search.php" method="get">
        <table cellspacing="0" cellpadding="0" border="0">
          <tr>
            <td><label>&nbsp;<u>S</u>earch&nbsp;for&nbsp;</label></td>
            <td><input type="text" name="query" value="" size="20" accesskey="s"/></td>
          </tr>
        </table>
      </form>
    </li>
  </ul></div>
<h1>D:/developpement/php/www/Stage/trunk/class/DBConnector.class.php</h1><a href="_d_b_connector_8class_8php.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 &lt;?php
<a name="l00002"></a>00002 set_include_path(<span class="stringliteral">"."</span>.PATH_SEPARATOR.<span class="stringliteral">".."</span>);
<a name="l00003"></a>00003 <span class="keywordflow">if</span>(!isset($ROOT_PATH))
<a name="l00004"></a>00004 require_once(<span class="stringliteral">"inc/main.inc.php"</span>);
<a name="l00009"></a><a class="code" href="class_d_b_connector.html">00009</a> <span class="keyword">abstract</span> <span class="keyword">class </span><a class="code" href="class_d_b_connector.html">DBConnector</a>{
<a name="l00010"></a><a class="code" href="class_d_b_connector.html#4b345fa11cae35066a23da5c89438e2e">00010</a>     <span class="keyword">private</span> <span class="keyword">static</span> <a class="code" href="class_d_b_connector.html#4b345fa11cae35066a23da5c89438e2e">$_dbConnector</a>;
<a name="l00011"></a><a class="code" href="class_d_b_connector.html#98d5ddb65ce2121429041e5248a9e350">00011</a>     <span class="keyword">private</span> <a class="code" href="class_d_b_connector.html#98d5ddb65ce2121429041e5248a9e350">$_connexionPersistance</a>=<span class="keyword">false</span>;
<a name="l00012"></a><a class="code" href="class_d_b_connector.html#5bcf3cfbf220aca484e9e289ce2f68fe">00012</a>     <span class="keyword">private</span> <a class="code" href="class_d_b_connector.html#5bcf3cfbf220aca484e9e289ce2f68fe">$_currentConnexion</a>=null;
<a name="l00013"></a>00013     
<a name="l00018"></a><a class="code" href="class_d_b_connector.html#8f1bdcc7c0062832d0cf8997f665ec55">00018</a>     <span class="keyword">public</span> function <a class="code" href="class_d_b_connector.html#8f1bdcc7c0062832d0cf8997f665ec55">forceConnexionPersistance</a>($forced=<span class="keyword">true</span>){
<a name="l00019"></a>00019         <span class="keywordflow">if</span>($forced &amp;&amp; !$this-&gt;_connexionPersistance)
<a name="l00020"></a>00020             $this-&gt;<a class="code" href="class_d_b_connector.html#8d40f1aa08e196a9e797fb02817ec884">connect</a>();
<a name="l00021"></a>00021         
<a name="l00022"></a>00022         <span class="keywordflow">if</span>($this-&gt;_connexionPersistance &amp;&amp; !$forced){
<a name="l00023"></a>00023             $this-&gt;<a class="code" href="class_d_b_connector.html#5da540f50a8068b4dd492ce6a740d482">__disconnect</a>();
<a name="l00024"></a>00024             $this-&gt;_currentConnexion=null;
<a name="l00025"></a>00025         }
<a name="l00026"></a>00026         
<a name="l00027"></a>00027         $this-&gt;_connexionPersistance = $forced;
<a name="l00028"></a>00028     }
<a name="l00029"></a>00029     
<a name="l00034"></a><a class="code" href="class_d_b_connector.html#e023e67efe564e1ff52da34833e38823">00034</a>     <span class="keyword">public</span> <span class="keyword">static</span> function <a class="code" href="class_d_b_connector.html#e023e67efe564e1ff52da34833e38823">setDBConnector</a>($dbConnector){
<a name="l00035"></a>00035         <span class="keywordflow">if</span>($dbConnector instanceof <a class="code" href="class_d_b_connector.html">DBConnector</a>)
<a name="l00036"></a>00036             <a class="code" href="class_d_b_connector.html#4b345fa11cae35066a23da5c89438e2e">DBConnector::$_dbConnector</a> = $dbConnector;
<a name="l00037"></a>00037         <span class="keywordflow">else</span> die(<span class="stringliteral">"Tentative de spécification d'un mauvais connecteur à la base de données : $dbConnector !"</span>);
<a name="l00038"></a>00038     }
<a name="l00039"></a>00039 
<a name="l00047"></a><a class="code" href="class_d_b_connector.html#c3826a8c8451516869fa05bc6d680e3c">00047</a>     <span class="keyword">public</span> function <a class="code" href="class_d_b_connector.html#c3826a8c8451516869fa05bc6d680e3c">executeQuery</a>($sql, $recordBegin=0, $recordCount=-1){
<a name="l00048"></a>00048         $currentConnexion = $this-&gt;<a class="code" href="class_d_b_connector.html#8d40f1aa08e196a9e797fb02817ec884">connect</a>();
<a name="l00049"></a>00049 
<a name="l00050"></a>00050         <a class="code" href="class_debugger.html#b8a5e20ce9c68f79bc43ebe975146ba1">Debugger::getInstance</a>()-&gt;traceBDD(<span class="stringliteral">"&lt;i&gt;Execution de la requête&lt;/i&gt; : $sql&lt;br/&gt;"</span>);
<a name="l00051"></a>00051         <span class="keywordflow">if</span>(eregi(<span class="stringliteral">"[:space:]*INSERT"</span>, $sql))
<a name="l00052"></a>00052             $res = $this-&gt;<a class="code" href="class_d_b_connector.html#b2d6428e8f2f3822f2ac7982b236a380">__executeInsert</a>($sql, $currentConnexion);
<a name="l00053"></a>00053         <span class="keywordflow">else</span>
<a name="l00054"></a>00054             $res = $this-&gt;<a class="code" href="class_d_b_connector.html#6bfd0a4664cc0457919125c08737c544">__executeQuery</a>($sql, $currentConnexion, $recordBegin, $recordCount);
<a name="l00055"></a>00055         
<a name="l00056"></a>00056         $this-&gt;<a class="code" href="class_d_b_connector.html#36ea80ddd2dd49030ad748974872cde2">disconnect</a>();
<a name="l00057"></a>00057         
<a name="l00058"></a>00058         <span class="keywordflow">return</span> $res;
<a name="l00059"></a>00059     }
<a name="l00060"></a>00060         
<a name="l00066"></a><a class="code" href="class_d_b_connector.html#39ca72ef73ff89df072e8f676d37f111">00066</a>         <span class="keyword">public</span> <span class="keyword">static</span> function <a class="code" href="class_d_b_connector.html#39ca72ef73ff89df072e8f676d37f111">cryptText</a>($text) 
<a name="l00067"></a>00067         {
<a name="l00068"></a>00068         <a class="code" href="class_debugger.html#b8a5e20ce9c68f79bc43ebe975146ba1">Debugger::getInstance</a>()-&gt;traceBDD(<span class="stringliteral">"&lt;i&gt;Cryptage du texte&lt;/i&gt; : $text&lt;br/&gt;"</span>);
<a name="l00069"></a>00069                 <span class="keywordflow">if</span> (!ctype_digit($text) &amp;&amp; !is_integer($text))
<a name="l00070"></a>00070                 {
<a name="l00071"></a>00071                         <span class="keywordflow">return</span> base64_encode($text);
<a name="l00072"></a>00072                 }
<a name="l00073"></a>00073                 <span class="keywordflow">return</span> $text;
<a name="l00074"></a>00074         }
<a name="l00075"></a>00075 
<a name="l00081"></a><a class="code" href="class_d_b_connector.html#66089918c4ef122ff667a522a9890148">00081</a>         <span class="keyword">public</span> <span class="keyword">static</span> function <a class="code" href="class_d_b_connector.html#66089918c4ef122ff667a522a9890148">decryptText</a>($text)
<a name="l00082"></a>00082         {
<a name="l00083"></a>00083         <a class="code" href="class_debugger.html#b8a5e20ce9c68f79bc43ebe975146ba1">Debugger::getInstance</a>()-&gt;traceBDD(<span class="stringliteral">"&lt;i&gt;Décryptage du texte&lt;/i&gt; : $text&lt;br/&gt;"</span>);
<a name="l00084"></a>00084                 <span class="keywordflow">if</span> (!ctype_digit($text)  &amp;&amp; !is_integer($text))
<a name="l00085"></a>00085                 {
<a name="l00086"></a>00086                         <span class="keywordflow">return</span> base64_decode($text);
<a name="l00087"></a>00087                 }
<a name="l00088"></a>00088                 <span class="keywordflow">return</span> $text;
<a name="l00089"></a>00089         }
<a name="l00090"></a>00090     
<a name="l00096"></a><a class="code" href="class_d_b_connector.html#0e4d039c5ef988b4301c93183607de9f">00096</a>     <span class="keyword">public</span> function <a class="code" href="class_d_b_connector.html#0e4d039c5ef988b4301c93183607de9f">computeDate</a>($date){
<a name="l00097"></a>00097         <span class="keywordflow">return</span> $this-&gt;<a class="code" href="class_d_b_connector.html#7e045fa88f8da29970d6f300eeb2896b">__computeDate</a>($date, $GLOBALS['DATE_FORMAT']);
<a name="l00098"></a>00098     }
<a name="l00099"></a>00099         
<a name="l00105"></a><a class="code" href="class_d_b_connector.html#5bfded551acc3d6055c7079bdb89ec50">00105</a>     <span class="keyword">public</span> function <a class="code" href="class_d_b_connector.html#5bfded551acc3d6055c7079bdb89ec50">decomputeDate</a>($dbDate){
<a name="l00106"></a>00106         <span class="keywordflow">return</span> $this-&gt;<a class="code" href="class_d_b_connector.html#dba8fd7c2702b5d7b903aaf8262eb2f1">__decomputeDate</a>($dbDate, $GLOBALS['DATE_FORMAT']);
<a name="l00107"></a>00107     }
<a name="l00108"></a>00108     
<a name="l00114"></a><a class="code" href="class_d_b_connector.html#bf384bdf6c10db88bffb8f608aa31d7f">00114</a>     <span class="keyword">public</span> function <a class="code" href="class_d_b_connector.html#bf384bdf6c10db88bffb8f608aa31d7f">computeTime</a>($time){
<a name="l00115"></a>00115         <span class="keywordflow">return</span> $this-&gt;<a class="code" href="class_d_b_connector.html#63e6c4ef6e963c98956ccfb7f8099eb2">__computeTime</a>($time, $GLOBALS['TIME_FORMAT']);
<a name="l00116"></a>00116     }
<a name="l00117"></a>00117         
<a name="l00123"></a><a class="code" href="class_d_b_connector.html#4d18c37c9fc615cab01ff722f91f2672">00123</a>     <span class="keyword">public</span> function <a class="code" href="class_d_b_connector.html#4d18c37c9fc615cab01ff722f91f2672">decomputeTime</a>($dbTime){
<a name="l00124"></a>00124         <span class="keywordflow">return</span> $this-&gt;<a class="code" href="class_d_b_connector.html#90a0966debdc8956b04396ecf4cb3783">__decomputeTime</a>($dbTime, $GLOBALS['TIME_FORMAT']);
<a name="l00125"></a>00125     }
<a name="l00126"></a>00126     
<a name="l00132"></a><a class="code" href="class_d_b_connector.html#a349d1e09acfb82d994da5fb2a8ea4b2">00132</a>     <span class="keyword">public</span> function <a class="code" href="class_d_b_connector.html#a349d1e09acfb82d994da5fb2a8ea4b2">computeDateTime</a>($dateTime){
<a name="l00133"></a>00133         <span class="keywordflow">return</span> $this-&gt;<a class="code" href="class_d_b_connector.html#684bd947e5906d0a2d24f771d9820adb">__computeDateTime</a>($dateTime, $GLOBALS['DATE_FORMAT'].<span class="stringliteral">" "</span>.$GLOBALS['TIME_FORMAT']);
<a name="l00134"></a>00134     }
<a name="l00135"></a>00135         
<a name="l00141"></a><a class="code" href="class_d_b_connector.html#99a718f13db890b263c91a6347062e6c">00141</a>     <span class="keyword">public</span> function <a class="code" href="class_d_b_connector.html#99a718f13db890b263c91a6347062e6c">decomputeDateTime</a>($dbDateTime){
<a name="l00142"></a>00142         <span class="keywordflow">return</span> $this-&gt;<a class="code" href="class_d_b_connector.html#23c4f021f1d3c51c75330a0711b929b5">__decomputeDateTime</a>($dbDateTime, $GLOBALS['DATE_FORMAT'].<span class="stringliteral">" "</span>.$GLOBALS['TIME_FORMAT']);
<a name="l00143"></a>00143     }
<a name="l00144"></a>00144 
<a name="l00149"></a><a class="code" href="class_d_b_connector.html#8d40f1aa08e196a9e797fb02817ec884">00149</a>     <span class="keyword">protected</span> function <a class="code" href="class_d_b_connector.html#8d40f1aa08e196a9e797fb02817ec884">connect</a>(){
<a name="l00150"></a>00150         <span class="keywordflow">if</span>(!$this-&gt;_connexionPersistance){
<a name="l00151"></a>00151             <span class="keywordflow">return</span> $this-&gt;<a class="code" href="class_d_b_connector.html#e6572c878d026d0463498e1b1eb4408b">__connect</a>();
<a name="l00152"></a>00152         }
<a name="l00153"></a>00153         <span class="keywordflow">else</span> <span class="keywordflow">if</span>($this-&gt;_currentConnexion == null){
<a name="l00154"></a>00154             $this-&gt;_currentConnexion = $this-&gt;<a class="code" href="class_d_b_connector.html#e6572c878d026d0463498e1b1eb4408b">__connect</a>();
<a name="l00155"></a>00155         }
<a name="l00156"></a>00156         <span class="keywordflow">return</span> $this-&gt;_currentConnexion;
<a name="l00157"></a>00157     }
<a name="l00158"></a>00158     
<a name="l00162"></a><a class="code" href="class_d_b_connector.html#36ea80ddd2dd49030ad748974872cde2">00162</a>     <span class="keyword">protected</span> function <a class="code" href="class_d_b_connector.html#36ea80ddd2dd49030ad748974872cde2">disconnect</a>(){
<a name="l00163"></a>00163         <span class="keywordflow">if</span>(!$this-&gt;_connexionPersistance){
<a name="l00164"></a>00164             $this-&gt;<a class="code" href="class_d_b_connector.html#5da540f50a8068b4dd492ce6a740d482">__disconnect</a>();
<a name="l00165"></a>00165             $this-&gt;_currentConnexion=null;
<a name="l00166"></a>00166         }
<a name="l00167"></a>00167     }
<a name="l00168"></a>00168     
<a name="l00172"></a><a class="code" href="class_d_b_connector.html#43db9aca89fd7bf7ecd0643174246776">00172</a>     <span class="keyword">public</span> <span class="keyword">static</span> function <a class="code" href="class_d_b_connector.html#43db9aca89fd7bf7ecd0643174246776">getDBConnector</a>(){ <span class="keywordflow">return</span> <a class="code" href="class_d_b_connector.html#4b345fa11cae35066a23da5c89438e2e">DBConnector::$_dbConnector</a>; }
<a name="l00173"></a>00173     
<a name="l00177"></a>00177     <span class="keyword">abstract</span> <span class="keyword">protected</span> function <a class="code" href="class_d_b_connector.html#e6572c878d026d0463498e1b1eb4408b">__connect</a>();
<a name="l00181"></a>00181     <span class="keyword">abstract</span> <span class="keyword">protected</span> function <a class="code" href="class_d_b_connector.html#5da540f50a8068b4dd492ce6a740d482">__disconnect</a>();
<a name="l00188"></a>00188     <span class="keyword">abstract</span> <span class="keyword">protected</span> function <a class="code" href="class_d_b_connector.html#b2d6428e8f2f3822f2ac7982b236a380">__executeInsert</a>($sql, $currentConnexion);
<a name="l00197"></a>00197     <span class="keyword">abstract</span> <span class="keyword">protected</span> function <a class="code" href="class_d_b_connector.html#6bfd0a4664cc0457919125c08737c544">__executeQuery</a>($sql, $currentConnexion, $recordBegin=0, $recordCount=-1);
<a name="l00203"></a>00203     <span class="keyword">abstract</span> <span class="keyword">public</span> function <a class="code" href="class_d_b_connector.html#9ba6ddc4a5229c8a11270f2ccdea4546">fetchArray</a>($res);
<a name="l00209"></a>00209     <span class="keyword">abstract</span> <span class="keyword">public</span> function <a class="code" href="class_d_b_connector.html#49eda822cec3e474942aa434e29f8063">processInt</a>($int);
<a name="l00215"></a>00215     <span class="keyword">abstract</span> <span class="keyword">public</span> function <a class="code" href="class_d_b_connector.html#163fc67c59ab73758c113944e0975e2e">processString</a>($string);
<a name="l00221"></a>00221     <span class="keyword">abstract</span> <span class="keyword">public</span> function <a class="code" href="class_d_b_connector.html#eaae3287dba161cda7eeef7bdf39599a">processObject</a>($object);
<a name="l00226"></a>00226     <span class="keyword">abstract</span> <span class="keyword">public</span> function <a class="code" href="class_d_b_connector.html#551754af43802b515feded9cdbf3fe41">databaseExists</a>();
<a name="l00231"></a>00231     <span class="keyword">abstract</span> <span class="keyword">public</span> function <a class="code" href="class_d_b_connector.html#c41e4821025107ff5cdb163c5065b54a">createDatabase</a>();
<a name="l00236"></a>00236     <span class="keyword">abstract</span> <span class="keyword">public</span> function <a class="code" href="class_d_b_connector.html#f51d16481dd1edbec21bfebd5e5351b1">dropDatabase</a>();
<a name="l00242"></a>00242     <span class="keyword">abstract</span> <span class="keyword">public</span> function <a class="code" href="class_d_b_connector.html#13725170bd1c462eb8e3dbeb00dac959">echapString</a>($text);
<a name="l00249"></a>00249     <span class="keyword">abstract</span> <span class="keyword">protected</span> function <a class="code" href="class_d_b_connector.html#7e045fa88f8da29970d6f300eeb2896b">__computeDate</a>($date, $dateFormat);
<a name="l00256"></a>00256     <span class="keyword">abstract</span> <span class="keyword">protected</span> function <a class="code" href="class_d_b_connector.html#dba8fd7c2702b5d7b903aaf8262eb2f1">__decomputeDate</a>($dbDate, $dateFormat);
<a name="l00263"></a>00263     <span class="keyword">abstract</span> <span class="keyword">protected</span> function <a class="code" href="class_d_b_connector.html#63e6c4ef6e963c98956ccfb7f8099eb2">__computeTime</a>($time, $timeFormat);
<a name="l00270"></a>00270     <span class="keyword">abstract</span> <span class="keyword">protected</span> function <a class="code" href="class_d_b_connector.html#90a0966debdc8956b04396ecf4cb3783">__decomputeTime</a>($dbTime, $timeFormat);
<a name="l00277"></a>00277     <span class="keyword">abstract</span> <span class="keyword">protected</span> function <a class="code" href="class_d_b_connector.html#684bd947e5906d0a2d24f771d9820adb">__computeDateTime</a>($dateTime, $dateTimeFormat);
<a name="l00284"></a>00284     <span class="keyword">abstract</span> <span class="keyword">protected</span> function <a class="code" href="class_d_b_connector.html#23c4f021f1d3c51c75330a0711b929b5">__decomputeDateTime</a>($dbDateTime, $dateTimeFormat);
<a name="l00285"></a>00285 }
<a name="l00286"></a>00286 ?&gt;
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Wed Mar 28 11:48:05 2007 for Stage by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.1-p1 </small></address>
</body>
</html>
