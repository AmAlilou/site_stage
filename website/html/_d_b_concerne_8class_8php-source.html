<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>Stage: D:/developpement/php/www/Stage/trunk/class/DBClasses/DBConcerne.class.php Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.1-p1 -->
<div class="tabs">
  <ul>
    <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
    <li><a href="namespaces.html"><span>Namespaces</span></a></li>
    <li><a href="annotated.html"><span>Classes</span></a></li>
    <li id="current"><a href="files.html"><span>Files</span></a></li>
    <li>
      <form action="search.php" method="get">
        <table cellspacing="0" cellpadding="0" border="0">
          <tr>
            <td><label>&nbsp;<u>S</u>earch&nbsp;for&nbsp;</label></td>
            <td><input type="text" name="query" value="" size="20" accesskey="s"/></td>
          </tr>
        </table>
      </form>
    </li>
  </ul></div>
<h1>D:/developpement/php/www/Stage/trunk/class/DBClasses/DBConcerne.class.php</h1><a href="_d_b_concerne_8class_8php.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 &lt;?php
<a name="l00002"></a>00002 set_include_path(<span class="stringliteral">"."</span>.PATH_SEPARATOR.<span class="stringliteral">".."</span>.PATH_SEPARATOR.<span class="stringliteral">"../.."</span>);
<a name="l00003"></a>00003 <span class="keywordflow">if</span>(!isset($ROOT_PATH))
<a name="l00004"></a>00004 require_once(<span class="stringliteral">"inc/main.inc.php"</span>);
<a name="l00005"></a>00005 
<a name="l00006"></a>00006 <span class="comment">// Généré via PHPClassGenerator via l'url index.php?nb_champs=2&amp;nom_table=Concerne&amp;nom_champ_1=id_type_stage&amp;type_champ_1=3&amp;taille_champ_1=&amp;champ_facultatif_1=&amp;valeur_defaut_1=&amp;auto_increment_1=&amp;clef_primaire_1=on&amp;getter_1=on&amp;setter_1=&amp;nom_champ_2=id_proposition_stage&amp;type_champ_2=3&amp;taille_champ_2=&amp;champ_facultatif_2=&amp;valeur_defaut_2=&amp;auto_increment_2=&amp;clef_primaire_2=on&amp;getter_2=on&amp;setter_2=</span>
<a name="l00007"></a>00007 
<a name="l00012"></a><a class="code" href="class_d_b_concerne.html">00012</a> <span class="keyword">class </span><a class="code" href="class_d_b_concerne.html">DBConcerne</a> {
<a name="l00013"></a>00013 
<a name="l00014"></a><a class="code" href="class_d_b_concerne.html#92d571f31e8ac7714c6d34772b6181e8">00014</a>     <span class="keyword">private</span> <span class="keyword">static</span> <a class="code" href="class_d_b_concerne.html#92d571f31e8ac7714c6d34772b6181e8">$TABLE_NAME</a> = <span class="stringliteral">"proposition_concerne"</span>;
<a name="l00015"></a><a class="code" href="class_d_b_concerne.html#2b8d3b01fd8c690ff4393204dc11730e">00015</a>     <span class="keyword">private</span> <span class="keyword">static</span> <a class="code" href="class_d_b_concerne.html#2b8d3b01fd8c690ff4393204dc11730e">$FIELD_ID_TYPE_STAGE</a> = <span class="stringliteral">"id_type_stage"</span>;
<a name="l00016"></a><a class="code" href="class_d_b_concerne.html#9d22fa33f37e00a836607cdf3a22f144">00016</a>     <span class="keyword">private</span> <span class="keyword">static</span> <a class="code" href="class_d_b_concerne.html#9d22fa33f37e00a836607cdf3a22f144">$FIELD_ID_PROPOSITION_STAGE</a> = <span class="stringliteral">"id_proposition_stage"</span>;
<a name="l00017"></a><a class="code" href="class_d_b_concerne.html#409b4a7605ee5620b13f23925ef3e7e4">00017</a>     <span class="keyword">private</span> <a class="code" href="class_d_b_concerne.html#409b4a7605ee5620b13f23925ef3e7e4">$_idTypeStage</a>;    
<a name="l00018"></a><a class="code" href="class_d_b_concerne.html#50f693a92c51ea8185ece5d1f4ecee19">00018</a>     <span class="keyword">private</span> <a class="code" href="class_d_b_concerne.html#50f693a92c51ea8185ece5d1f4ecee19">$_idPropositionStage</a>;
<a name="l00019"></a>00019 
<a name="l00026"></a><a class="code" href="class_d_b_concerne.html#b4bd79096a5c880adebbf173496582c3">00026</a>     <span class="keyword">private</span>  function <a class="code" href="class_d_b_concerne.html#b4bd79096a5c880adebbf173496582c3">__construct</a>($idTypeStage, $idPropositionStage){
<a name="l00027"></a>00027         $this-&gt;_idTypeStage = $idTypeStage;
<a name="l00028"></a>00028         $this-&gt;_idPropositionStage = $idPropositionStage;
<a name="l00029"></a>00029     }
<a name="l00030"></a>00030 
<a name="l00031"></a>00031 
<a name="l00037"></a><a class="code" href="class_d_b_concerne.html#6c206e0bb180edfaf8da3ba4584bae25">00037</a>     <span class="keyword">public</span>  function <a class="code" href="class_d_b_concerne.html#6c206e0bb180edfaf8da3ba4584bae25">getIdTypeStage</a>(){
<a name="l00038"></a>00038         <span class="keywordflow">return</span> $this-&gt;_idTypeStage;
<a name="l00039"></a>00039     }
<a name="l00040"></a><a class="code" href="class_d_b_concerne.html#692c18fe0ff52f475942888a0d45caee">00040</a>     <span class="keyword">public</span>  function <a class="code" href="class_d_b_concerne.html#692c18fe0ff52f475942888a0d45caee">getIdPropositionStage</a>(){
<a name="l00041"></a>00041         <span class="keywordflow">return</span> $this-&gt;_idPropositionStage;
<a name="l00042"></a>00042     }
<a name="l00043"></a>00043     
<a name="l00049"></a><a class="code" href="class_d_b_concerne.html#7881cf33b03a12c0be061e0623ec810d">00049</a>         <span class="keyword">public</span> function <a class="code" href="class_d_b_concerne.html#7881cf33b03a12c0be061e0623ec810d">getTypeStage</a>(){
<a name="l00050"></a>00050         $typesStage = <a class="code" href="class_d_b_type_stage.html#83fd19172ee91023b7cbb7a2990a0163">DBTypeStage::getRecords</a>($this-&gt;_idTypeStage);
<a name="l00051"></a>00051         assert(count($typesStage) == 1);
<a name="l00052"></a>00052         <span class="keywordflow">return</span> $typesStage[0];
<a name="l00053"></a>00053     }
<a name="l00054"></a>00054 
<a name="l00055"></a>00055 
<a name="l00061"></a><a class="code" href="class_d_b_concerne.html#9543e8307adb58c647f809b663d9dcfe">00061</a>     <span class="keyword">public</span> <span class="keyword">static</span> function <a class="code" href="class_d_b_concerne.html#9543e8307adb58c647f809b663d9dcfe">tableExists</a>(){
<a name="l00062"></a>00062         <span class="keywordflow">return</span> <a class="code" href="class_d_b_connector.html#43db9aca89fd7bf7ecd0643174246776">DBConnector::getDBConnector</a>()-&gt;tableExists(<a class="code" href="class_d_b_concerne.html#92d571f31e8ac7714c6d34772b6181e8">DBConcerne::$TABLE_NAME</a>);
<a name="l00063"></a>00063     }
<a name="l00064"></a>00064 
<a name="l00065"></a>00065 
<a name="l00070"></a><a class="code" href="class_d_b_concerne.html#ff33cd7d6364d24ffa3cc41c2ca8f7c7">00070</a>     <span class="keyword">public</span> <span class="keyword">static</span> function <a class="code" href="class_d_b_concerne.html#ff33cd7d6364d24ffa3cc41c2ca8f7c7">createTable</a>(){
<a name="l00071"></a>00071         $sql = <span class="stringliteral">"CREATE TABLE `"</span>.DBConcerne::$TABLE_NAME.<span class="stringliteral">"` (</span>
<a name="l00072"></a>00072 <span class="stringliteral">                            `"</span>.<a class="code" href="class_d_b_concerne.html#2b8d3b01fd8c690ff4393204dc11730e">DBConcerne::$FIELD_ID_TYPE_STAGE</a>.<span class="stringliteral">"` INT(11) NOT NULL  ,  </span>
<a name="l00073"></a>00073 <span class="stringliteral">                            `"</span>.<a class="code" href="class_d_b_concerne.html#9d22fa33f37e00a836607cdf3a22f144">DBConcerne::$FIELD_ID_PROPOSITION_STAGE</a>.<span class="stringliteral">"` INT(11) NOT NULL  ,</span>
<a name="l00074"></a>00074 <span class="stringliteral">                            PRIMARY KEY (`"</span>.<a class="code" href="class_d_b_concerne.html#2b8d3b01fd8c690ff4393204dc11730e">DBConcerne::$FIELD_ID_TYPE_STAGE</a>.<span class="stringliteral">"`,`"</span>.<a class="code" href="class_d_b_concerne.html#9d22fa33f37e00a836607cdf3a22f144">DBConcerne::$FIELD_ID_PROPOSITION_STAGE</a>.<span class="stringliteral">"`)</span>
<a name="l00075"></a>00075 <span class="stringliteral">                ) ENGINE=MyISAM DEFAULT CHARSET=latin1;"</span>;
<a name="l00076"></a>00076         
<a name="l00077"></a>00077         
<a name="l00078"></a>00078         foreach(explode(<span class="stringliteral">";"</span>, $sql) as $query)
<a name="l00079"></a>00079         {
<a name="l00080"></a>00080             <span class="keywordflow">if</span>($query != <span class="stringliteral">""</span>)
<a name="l00081"></a>00081                 <a class="code" href="class_d_b_connector.html#43db9aca89fd7bf7ecd0643174246776">DBConnector::getDBConnector</a>()-&gt;executeQuery($query);
<a name="l00082"></a>00082         }
<a name="l00083"></a>00083     }
<a name="l00084"></a>00084 
<a name="l00085"></a>00085 
<a name="l00086"></a>00086         
<a name="l00093"></a><a class="code" href="class_d_b_concerne.html#9c1212dc7fce9631d9f5c7165c19882d">00093</a>     <span class="keyword">public</span> <span class="keyword">static</span> function <a class="code" href="class_d_b_concerne.html#9c1212dc7fce9631d9f5c7165c19882d">createRecord</a>($typeStage, $propositionStage){
<a name="l00094"></a>00094         assert($typeStage instanceof <a class="code" href="class_d_b_type_stage.html">DBTypeStage</a>);
<a name="l00095"></a>00095         assert($propositionStage instanceof <a class="code" href="class_d_b_proposition_stage.html">DBPropositionStage</a>);
<a name="l00096"></a>00096         $sql = <span class="stringliteral">"INSERT INTO "</span>.DBConcerne::$TABLE_NAME.<span class="stringliteral">" ("</span>
<a name="l00097"></a>00097                             .DBConcerne::$FIELD_ID_TYPE_STAGE.<span class="stringliteral">", "</span>
<a name="l00098"></a>00098                             .DBConcerne::$FIELD_ID_PROPOSITION_STAGE.<span class="stringliteral">" "</span>
<a name="l00099"></a>00099                             .<span class="stringliteral">") VALUES ("</span>
<a name="l00100"></a>00100                             .DBConnector::getDBConnector()-&gt;processInt($typeStage-&gt;<a class="code" href="class_d_b_concerne.html#6c206e0bb180edfaf8da3ba4584bae25">getIdTypeStage</a>()).<span class="stringliteral">", "</span>
<a name="l00101"></a>00101                             .DBConnector::getDBConnector()-&gt;processInt($propositionStage-&gt;<a class="code" href="class_d_b_concerne.html#692c18fe0ff52f475942888a0d45caee">getIdPropositionStage</a>()).<span class="stringliteral">" "</span>
<a name="l00102"></a>00102                             .<span class="stringliteral">")"</span>;
<a name="l00103"></a>00103         
<a name="l00104"></a>00104         $id = <a class="code" href="class_d_b_connector.html#43db9aca89fd7bf7ecd0643174246776">DBConnector::getDBConnector</a>()-&gt;executeQuery($sql);
<a name="l00105"></a>00105         
<a name="l00106"></a>00106         $obj = <a class="code" href="class_d_b_concerne.html#9720e13bcb7689df707372cda916b2d1">DBConcerne::getRecords</a>($typeStage-&gt;<a class="code" href="class_d_b_concerne.html#6c206e0bb180edfaf8da3ba4584bae25">getIdTypeStage</a>(), $propositionStage-&gt;<a class="code" href="class_d_b_concerne.html#692c18fe0ff52f475942888a0d45caee">getIdPropositionStage</a>());
<a name="l00107"></a>00107         assert(count($obj) == 1);
<a name="l00108"></a>00108         <span class="keywordflow">return</span> $obj[0];
<a name="l00109"></a>00109     }
<a name="l00110"></a>00110 
<a name="l00111"></a>00111 
<a name="l00119"></a><a class="code" href="class_d_b_concerne.html#9720e13bcb7689df707372cda916b2d1">00119</a>     <span class="keyword">public</span> <span class="keyword">static</span> function <a class="code" href="class_d_b_concerne.html#9720e13bcb7689df707372cda916b2d1">getRecords</a>($idTypeStage=<span class="stringliteral">""</span>, $idPropositionStage=<span class="stringliteral">""</span>){
<a name="l00120"></a>00120         $sql = <span class="stringliteral">"SELECT * FROM "</span>.DBConcerne::$TABLE_NAME.<span class="stringliteral">" WHERE 1"</span>;
<a name="l00121"></a>00121         
<a name="l00122"></a>00122         <span class="keywordflow">if</span>($idTypeStage != <span class="stringliteral">""</span>)
<a name="l00123"></a>00123             $sql .= <span class="stringliteral">" AND "</span>.DBConcerne::$FIELD_ID_TYPE_STAGE.<span class="stringliteral">"="</span>.<a class="code" href="class_d_b_connector.html#43db9aca89fd7bf7ecd0643174246776">DBConnector::getDBConnector</a>()-&gt;processInt($idTypeStage);
<a name="l00124"></a>00124         <span class="keywordflow">if</span>($idPropositionStage != <span class="stringliteral">""</span>)
<a name="l00125"></a>00125             $sql .= <span class="stringliteral">" AND "</span>.DBConcerne::$FIELD_ID_PROPOSITION_STAGE.<span class="stringliteral">"="</span>.<a class="code" href="class_d_b_connector.html#43db9aca89fd7bf7ecd0643174246776">DBConnector::getDBConnector</a>()-&gt;processInt($idPropositionStage);
<a name="l00126"></a>00126         
<a name="l00127"></a>00127         $res = <a class="code" href="class_d_b_connector.html#43db9aca89fd7bf7ecd0643174246776">DBConnector::getDBConnector</a>()-&gt;executeQuery($sql);
<a name="l00128"></a>00128         
<a name="l00129"></a>00129         $return = array();
<a name="l00130"></a>00130         $i=0;
<a name="l00131"></a>00131         <span class="keywordflow">while</span>($result = <a class="code" href="class_d_b_connector.html#43db9aca89fd7bf7ecd0643174246776">DBConnector::getDBConnector</a>()-&gt;fetchArray($res)) {
<a name="l00132"></a>00132             $return[$i] = <span class="keyword">new</span> <a class="code" href="class_d_b_concerne.html">DBConcerne</a>(
<a name="l00133"></a>00133         
<a name="l00134"></a>00134                                             $result[<a class="code" href="class_d_b_concerne.html#2b8d3b01fd8c690ff4393204dc11730e">DBConcerne::$FIELD_ID_TYPE_STAGE</a>],
<a name="l00135"></a>00135                                             $result[<a class="code" href="class_d_b_concerne.html#9d22fa33f37e00a836607cdf3a22f144">DBConcerne::$FIELD_ID_PROPOSITION_STAGE</a>]
<a name="l00136"></a>00136                                         );
<a name="l00137"></a>00137             
<a name="l00138"></a>00138             $i++;
<a name="l00139"></a>00139         }
<a name="l00140"></a>00140         
<a name="l00141"></a>00141         <span class="keywordflow">return</span> $return;
<a name="l00142"></a>00142     }
<a name="l00143"></a>00143     
<a name="l00144"></a>00144         
<a name="l00145"></a>00145 
<a name="l00150"></a><a class="code" href="class_d_b_concerne.html#681198cf560b82081b88c7b2dfe388b2">00150</a>     <span class="keyword">public</span>  function <a class="code" href="class_d_b_concerne.html#681198cf560b82081b88c7b2dfe388b2">deleteRecord</a>(){
<a name="l00151"></a>00151         $sql = <span class="stringliteral">"DELETE FROM "</span>.DBConcerne::$TABLE_NAME.<span class="stringliteral">" WHERE 1"</span>;
<a name="l00152"></a>00152         
<a name="l00153"></a>00153         $sql .= <span class="stringliteral">" AND "</span>.DBConcerne::$FIELD_ID_TYPE_STAGE.<span class="stringliteral">"="</span>.<a class="code" href="class_d_b_connector.html#43db9aca89fd7bf7ecd0643174246776">DBConnector::getDBConnector</a>()-&gt;processInt($this-&gt;_idTypeStage);
<a name="l00154"></a>00154         $sql .= <span class="stringliteral">" AND "</span>.DBConcerne::$FIELD_ID_PROPOSITION_STAGE.<span class="stringliteral">"="</span>.<a class="code" href="class_d_b_connector.html#43db9aca89fd7bf7ecd0643174246776">DBConnector::getDBConnector</a>()-&gt;processInt($this-&gt;_idPropositionStage);
<a name="l00155"></a>00155         
<a name="l00156"></a>00156         <a class="code" href="class_d_b_connector.html#43db9aca89fd7bf7ecd0643174246776">DBConnector::getDBConnector</a>()-&gt;executeQuery($sql);
<a name="l00157"></a>00157     }
<a name="l00158"></a>00158 }
<a name="l00159"></a>00159 ?&gt;
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Wed Mar 28 11:48:05 2007 for Stage by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.1-p1 </small></address>
</body>
</html>
