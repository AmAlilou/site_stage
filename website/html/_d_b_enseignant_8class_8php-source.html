<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>Stage: D:/developpement/php/www/Stage/trunk/class/DBClasses/DBEnseignant.class.php Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.1-p1 -->
<div class="tabs">
  <ul>
    <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
    <li><a href="namespaces.html"><span>Namespaces</span></a></li>
    <li><a href="annotated.html"><span>Classes</span></a></li>
    <li id="current"><a href="files.html"><span>Files</span></a></li>
    <li>
      <form action="search.php" method="get">
        <table cellspacing="0" cellpadding="0" border="0">
          <tr>
            <td><label>&nbsp;<u>S</u>earch&nbsp;for&nbsp;</label></td>
            <td><input type="text" name="query" value="" size="20" accesskey="s"/></td>
          </tr>
        </table>
      </form>
    </li>
  </ul></div>
<h1>D:/developpement/php/www/Stage/trunk/class/DBClasses/DBEnseignant.class.php</h1><a href="_d_b_enseignant_8class_8php.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 &lt;?php
<a name="l00002"></a>00002 set_include_path(<span class="stringliteral">"."</span>.PATH_SEPARATOR.<span class="stringliteral">".."</span>.PATH_SEPARATOR.<span class="stringliteral">"../.."</span>);
<a name="l00003"></a>00003 require_once(<span class="stringliteral">"inc/main.inc.php"</span>);
<a name="l00004"></a>00004 
<a name="l00005"></a>00005 <span class="comment">// Généré via PHPClassGenerator via l'url index.php?nb_champs=7&amp;pgc_url=&amp;nom_table=enseignant&amp;nom_champ_1=id_enseignant&amp;type_champ_1=3&amp;taille_champ_1=&amp;champ_facultatif_1=&amp;valeur_defaut_1=&amp;auto_increment_1=on&amp;clef_primaire_1=on&amp;getter_1=on&amp;setter_1=&amp;nom_champ_2=nom_enseignant&amp;type_champ_2=1&amp;taille_champ_2=255&amp;champ_facultatif_2=&amp;valeur_defaut_2=&amp;auto_increment_2=&amp;clef_primaire_2=&amp;getter_2=on&amp;setter_2=&amp;nom_champ_3=prenom_enseignant&amp;type_champ_3=1&amp;taille_champ_3=255&amp;champ_facultatif_3=&amp;valeur_defaut_3=&amp;auto_increment_3=&amp;clef_primaire_3=&amp;getter_3=on&amp;setter_3=&amp;nom_champ_4=mail_enseignant&amp;type_champ_4=1&amp;taille_champ_4=255&amp;champ_facultatif_4=on&amp;valeur_defaut_4=NULL&amp;auto_increment_4=&amp;clef_primaire_4=&amp;getter_4=on&amp;setter_4=&amp;nom_champ_5=login_enseignant&amp;type_champ_5=1&amp;taille_champ_5=255&amp;champ_facultatif_5=on&amp;valeur_defaut_5=NULL&amp;auto_increment_5=&amp;clef_primaire_5=&amp;getter_5=on&amp;setter_5=&amp;nom_champ_6=password_enseignant&amp;type_champ_6=4&amp;taille_champ_6=&amp;champ_facultatif_6=on&amp;valeur_defaut_6=0&amp;auto_increment_6=&amp;clef_primaire_6=&amp;getter_6=on&amp;setter_6=&amp;nom_champ_7=date_derniere_recuperation_pass&amp;type_champ_7=10&amp;taille_champ_7=&amp;champ_facultatif_7=on&amp;valeur_defaut_7=&amp;auto_increment_7=&amp;clef_primaire_7=&amp;getter_7=on&amp;setter_7=&amp;</span>
<a name="l00006"></a>00006 
<a name="l00007"></a>00007 
<a name="l00012"></a><a class="code" href="class_d_b_enseignant.html">00012</a> <span class="keyword">class </span><a class="code" href="class_d_b_enseignant.html">DBEnseignant</a>  <span class="keyword">implements</span> <a class="code" href="interface_i_selectable.html">ISelectable</a>   {
<a name="l00013"></a>00013     
<a name="l00017"></a><a class="code" href="class_d_b_enseignant.html#f9dc84610fdafaf97e25e4651b82d64f">00017</a>         <span class="keyword">public</span> <span class="keyword">static</span> <a class="code" href="class_d_b_enseignant.html#f9dc84610fdafaf97e25e4651b82d64f">$STATUT_ENSEIGNANT_ACTIF</a> = 'actif' ;
<a name="l00021"></a><a class="code" href="class_d_b_enseignant.html#279fa85316e4ddace6a4be04ba48b271">00021</a>         <span class="keyword">public</span> <span class="keyword">static</span> <a class="code" href="class_d_b_enseignant.html#279fa85316e4ddace6a4be04ba48b271">$STATUT_ENSEIGNANT_PASSIF</a> = 'passif' ;
<a name="l00022"></a>00022         
<a name="l00023"></a>00023         
<a name="l00024"></a><a class="code" href="class_d_b_enseignant.html#5a9ff50d684193bb5a8ed9fa3dde4797">00024</a>         <span class="keyword">private</span> <span class="keyword">static</span> <a class="code" href="class_d_b_enseignant.html#5a9ff50d684193bb5a8ed9fa3dde4797">$TABLE_NAME</a> = <span class="stringliteral">"enseignant"</span>;
<a name="l00025"></a><a class="code" href="class_d_b_enseignant.html#d686f05c5197c924b553eddda615b883">00025</a>     <span class="keyword">private</span> <span class="keyword">static</span> <a class="code" href="class_d_b_enseignant.html#d686f05c5197c924b553eddda615b883">$FIELD_ID_ENSEIGNANT</a> = <span class="stringliteral">"id_enseignant"</span>;
<a name="l00026"></a><a class="code" href="class_d_b_enseignant.html#4e36abee585f222ca7c4084a562abd98">00026</a>     <span class="keyword">private</span> <span class="keyword">static</span> <a class="code" href="class_d_b_enseignant.html#4e36abee585f222ca7c4084a562abd98">$FIELD_NOM_ENSEIGNANT</a> = <span class="stringliteral">"nom_enseignant"</span>;
<a name="l00027"></a><a class="code" href="class_d_b_enseignant.html#f2f782c543fab1af1ebc32228e236a42">00027</a>     <span class="keyword">private</span> <span class="keyword">static</span> <a class="code" href="class_d_b_enseignant.html#f2f782c543fab1af1ebc32228e236a42">$FIELD_PRENOM_ENSEIGNANT</a> = <span class="stringliteral">"prenom_enseignant"</span>;
<a name="l00028"></a><a class="code" href="class_d_b_enseignant.html#6c582ad9ff477418bbbef1e17ae08717">00028</a>     <span class="keyword">private</span> <span class="keyword">static</span> <a class="code" href="class_d_b_enseignant.html#6c582ad9ff477418bbbef1e17ae08717">$FIELD_MAIL_ENSEIGNANT</a> = <span class="stringliteral">"mail_enseignant"</span>;
<a name="l00029"></a><a class="code" href="class_d_b_enseignant.html#e00b44d718d8a8d6b3c2b67290399296">00029</a>     <span class="keyword">private</span> <span class="keyword">static</span> <a class="code" href="class_d_b_enseignant.html#e00b44d718d8a8d6b3c2b67290399296">$FIELD_LOGIN_ENSEIGNANT</a> = <span class="stringliteral">"login_enseignant"</span>;
<a name="l00030"></a><a class="code" href="class_d_b_enseignant.html#f3ac8a24bd1d759b935bebcf8795921d">00030</a>     <span class="keyword">private</span> <span class="keyword">static</span> <a class="code" href="class_d_b_enseignant.html#f3ac8a24bd1d759b935bebcf8795921d">$FIELD_PASSWORD_ENSEIGNANT</a> = <span class="stringliteral">"password_enseignant"</span>;
<a name="l00031"></a><a class="code" href="class_d_b_enseignant.html#51f7e4adfcf93cc501211ff00c832a76">00031</a>     <span class="keyword">private</span> <span class="keyword">static</span> <a class="code" href="class_d_b_enseignant.html#51f7e4adfcf93cc501211ff00c832a76">$FIELD_DATE_DERNIERE_RECUPERATION_PASS</a> = <span class="stringliteral">"date_derniere_recuperation_pass"</span>;
<a name="l00032"></a><a class="code" href="class_d_b_enseignant.html#2da62e115d9acc30823a0c5a66946ed7">00032</a>     <span class="keyword">private</span> <span class="keyword">static</span> <a class="code" href="class_d_b_enseignant.html#2da62e115d9acc30823a0c5a66946ed7">$FIELD_STATUT_ENSEIGNANT</a> = <span class="stringliteral">"statut_enseignant"</span>;
<a name="l00033"></a>00033 
<a name="l00034"></a><a class="code" href="class_d_b_enseignant.html#447ab9a4f2ae76fd7ead8512992dcb13">00034</a>     <span class="keyword">private</span> <a class="code" href="class_d_b_enseignant.html#447ab9a4f2ae76fd7ead8512992dcb13">$_idEnseignant</a>;
<a name="l00035"></a><a class="code" href="class_d_b_enseignant.html#cbea331520ca3e4d44f752ab94869670">00035</a>     <span class="keyword">private</span> <a class="code" href="class_d_b_enseignant.html#cbea331520ca3e4d44f752ab94869670">$_nomEnseignant</a>;
<a name="l00036"></a><a class="code" href="class_d_b_enseignant.html#761c9253717b18fe3707d0d8b5d5a458">00036</a>     <span class="keyword">private</span> <a class="code" href="class_d_b_enseignant.html#761c9253717b18fe3707d0d8b5d5a458">$_prenomEnseignant</a>;
<a name="l00037"></a><a class="code" href="class_d_b_enseignant.html#719107584139b31a2b759392f9bd3e4b">00037</a>     <span class="keyword">private</span> <a class="code" href="class_d_b_enseignant.html#719107584139b31a2b759392f9bd3e4b">$_mailEnseignant</a>;
<a name="l00038"></a><a class="code" href="class_d_b_enseignant.html#60011794443a3be646c4a8c27866d1a9">00038</a>     <span class="keyword">private</span> <a class="code" href="class_d_b_enseignant.html#60011794443a3be646c4a8c27866d1a9">$_loginEnseignant</a>;
<a name="l00039"></a><a class="code" href="class_d_b_enseignant.html#2cf6303dc2615acbb36bc9280fcbd20f">00039</a>     <span class="keyword">private</span> <a class="code" href="class_d_b_enseignant.html#2cf6303dc2615acbb36bc9280fcbd20f">$_passwordEnseignant</a>;
<a name="l00040"></a><a class="code" href="class_d_b_enseignant.html#e8ee0cc5d85f6fab9b9c94d11061a418">00040</a>     <span class="keyword">private</span> <a class="code" href="class_d_b_enseignant.html#e8ee0cc5d85f6fab9b9c94d11061a418">$_dateDerniereRecuperationPass</a>;
<a name="l00041"></a><a class="code" href="class_d_b_enseignant.html#bc80878708a195eb6fc1b2bfff2e643e">00041</a>     <span class="keyword">private</span> <a class="code" href="class_d_b_enseignant.html#bc80878708a195eb6fc1b2bfff2e643e">$_statutEnseignant</a>;
<a name="l00042"></a>00042 
<a name="l00043"></a><a class="code" href="class_d_b_enseignant.html#31e4cfbcb984a80a8440a65aa7419bb4">00043</a>     <span class="keyword">private</span> <span class="keyword">static</span> <a class="code" href="class_d_b_enseignant.html#31e4cfbcb984a80a8440a65aa7419bb4">$MAILPASS_TEMPLATE</a> = <span class="stringliteral">"/mailTemplates/mailPassEns"</span>;
<a name="l00044"></a><a class="code" href="class_d_b_enseignant.html#c7c6996ddd2c08896307d797aefe5cc2">00044</a>     <span class="keyword">private</span> <span class="keyword">static</span> <a class="code" href="class_d_b_enseignant.html#c7c6996ddd2c08896307d797aefe5cc2">$MAILPASSADMIN_TEMPLATE</a> = <span class="stringliteral">"/mailTemplates/mailPassAdminEns"</span>;
<a name="l00045"></a>00045 
<a name="l00058"></a><a class="code" href="class_d_b_enseignant.html#89152023180acd57f5fa6b6b2ba91dfd">00058</a>     <span class="keyword">private</span>  function <a class="code" href="class_d_b_enseignant.html#89152023180acd57f5fa6b6b2ba91dfd">__construct</a>($idEnseignant, $nomEnseignant, $prenomEnseignant, $mailEnseignant, $loginEnseignant, $passwordEnseignant, $dateDerniereRecuperationPass, $statutEnseignant){
<a name="l00059"></a>00059         $this-&gt;_idEnseignant = $idEnseignant;
<a name="l00060"></a>00060         $this-&gt;_nomEnseignant = $nomEnseignant;
<a name="l00061"></a>00061         $this-&gt;_prenomEnseignant = $prenomEnseignant;
<a name="l00062"></a>00062         $this-&gt;_mailEnseignant = $mailEnseignant;
<a name="l00063"></a>00063         $this-&gt;_loginEnseignant = $loginEnseignant;
<a name="l00064"></a>00064         $this-&gt;_passwordEnseignant = $passwordEnseignant;
<a name="l00065"></a>00065         $this-&gt;_dateDerniereRecuperationPass = $dateDerniereRecuperationPass;
<a name="l00066"></a>00066         $this-&gt;_statutEnseignant = $statutEnseignant;
<a name="l00067"></a>00067     }
<a name="l00068"></a>00068     
<a name="l00069"></a>00069         
<a name="l00075"></a><a class="code" href="class_d_b_enseignant.html#51b6e640a24219a654fd84dacf87a628">00075</a>         <span class="keyword">public</span>  function <a class="code" href="class_d_b_enseignant.html#51b6e640a24219a654fd84dacf87a628">getIdEnseignant</a>(){
<a name="l00076"></a>00076         <span class="keywordflow">return</span> $this-&gt;_idEnseignant;
<a name="l00077"></a>00077     }
<a name="l00078"></a><a class="code" href="class_d_b_enseignant.html#6d8941ff4dbd88c078f09aede0daed6f">00078</a>     <span class="keyword">public</span>  function <a class="code" href="class_d_b_enseignant.html#6d8941ff4dbd88c078f09aede0daed6f">getNomEnseignant</a>(){
<a name="l00079"></a>00079         <span class="keywordflow">return</span> $this-&gt;_nomEnseignant;
<a name="l00080"></a>00080     }
<a name="l00081"></a><a class="code" href="class_d_b_enseignant.html#05f5192dab3255ba348bf9712a3d3003">00081</a>     <span class="keyword">public</span>  function <a class="code" href="class_d_b_enseignant.html#05f5192dab3255ba348bf9712a3d3003">getPrenomEnseignant</a>(){
<a name="l00082"></a>00082         <span class="keywordflow">return</span> $this-&gt;_prenomEnseignant;
<a name="l00083"></a>00083     }
<a name="l00084"></a><a class="code" href="class_d_b_enseignant.html#fcdecbe686ba1dbc8e825439ee2cf3a7">00084</a>     <span class="keyword">public</span>  function <a class="code" href="class_d_b_enseignant.html#fcdecbe686ba1dbc8e825439ee2cf3a7">getMailEnseignant</a>(){
<a name="l00085"></a>00085         <span class="keywordflow">return</span> $this-&gt;_mailEnseignant;
<a name="l00086"></a>00086     }
<a name="l00087"></a><a class="code" href="class_d_b_enseignant.html#4cb0af7f120c280c3112a577f497cecb">00087</a>     <span class="keyword">public</span>  function <a class="code" href="class_d_b_enseignant.html#4cb0af7f120c280c3112a577f497cecb">getLoginEnseignant</a>(){
<a name="l00088"></a>00088         <span class="keywordflow">return</span> $this-&gt;_loginEnseignant;
<a name="l00089"></a>00089     }
<a name="l00090"></a><a class="code" href="class_d_b_enseignant.html#e8b5ffa1815cd9f27defb84cb56b9813">00090</a>     <span class="keyword">public</span>  function <a class="code" href="class_d_b_enseignant.html#e8b5ffa1815cd9f27defb84cb56b9813">getPasswordEnseignant</a>(){
<a name="l00091"></a>00091         <span class="keywordflow">return</span> $this-&gt;_passwordEnseignant;
<a name="l00092"></a>00092     }
<a name="l00093"></a><a class="code" href="class_d_b_enseignant.html#9a61ee69cc3d16e099d287d48e4b52b3">00093</a>     <span class="keyword">public</span>  function <a class="code" href="class_d_b_enseignant.html#9a61ee69cc3d16e099d287d48e4b52b3">getDateDerniereRecuperationPass</a>(){
<a name="l00094"></a>00094         <span class="keywordflow">return</span> $this-&gt;_dateDerniereRecuperationPass;
<a name="l00095"></a>00095     }
<a name="l00096"></a><a class="code" href="class_d_b_enseignant.html#7f2235700ab8fa68291455ea106dbf54">00096</a>         <span class="keyword">public</span> function <a class="code" href="class_d_b_enseignant.html#7f2235700ab8fa68291455ea106dbf54">getStatutEnseignant</a>() {
<a name="l00097"></a>00097                 <span class="keywordflow">return</span> $this-&gt;_statutEnseignant ;
<a name="l00098"></a>00098         }
<a name="l00099"></a>00099     
<a name="l00100"></a>00100         
<a name="l00106"></a><a class="code" href="class_d_b_enseignant.html#4aad486da6894823a838f087db486d98">00106</a>         <span class="keyword">public</span> <span class="keyword">static</span> function <a class="code" href="class_d_b_enseignant.html#4aad486da6894823a838f087db486d98">tableExists</a>(){
<a name="l00107"></a>00107         <span class="keywordflow">return</span> <a class="code" href="class_d_b_connector.html#43db9aca89fd7bf7ecd0643174246776">DBConnector::getDBConnector</a>()-&gt;tableExists(<a class="code" href="class_d_b_enseignant.html#5a9ff50d684193bb5a8ed9fa3dde4797">DBEnseignant::$TABLE_NAME</a>);
<a name="l00108"></a>00108     }
<a name="l00109"></a>00109     
<a name="l00110"></a>00110         
<a name="l00115"></a><a class="code" href="class_d_b_enseignant.html#f261029aa586ca1d4871b47e8f459954">00115</a>         <span class="keyword">public</span> <span class="keyword">static</span> function <a class="code" href="class_d_b_enseignant.html#f261029aa586ca1d4871b47e8f459954">createTable</a>(){
<a name="l00116"></a>00116         $sql = <span class="stringliteral">"CREATE TABLE `"</span>.DBEnseignant::$TABLE_NAME.<span class="stringliteral">"` (  </span>
<a name="l00117"></a>00117 <span class="stringliteral">                            `"</span>.<a class="code" href="class_d_b_enseignant.html#d686f05c5197c924b553eddda615b883">DBEnseignant::$FIELD_ID_ENSEIGNANT</a>.<span class="stringliteral">"` INT(11) NOT NULL  auto_increment,  </span>
<a name="l00118"></a>00118 <span class="stringliteral">                            `"</span>.<a class="code" href="class_d_b_enseignant.html#4e36abee585f222ca7c4084a562abd98">DBEnseignant::$FIELD_NOM_ENSEIGNANT</a>.<span class="stringliteral">"` VARCHAR(255) NOT NULL  ,  </span>
<a name="l00119"></a>00119 <span class="stringliteral">                            `"</span>.<a class="code" href="class_d_b_enseignant.html#f2f782c543fab1af1ebc32228e236a42">DBEnseignant::$FIELD_PRENOM_ENSEIGNANT</a>.<span class="stringliteral">"` VARCHAR(255) NOT NULL  ,  </span>
<a name="l00120"></a>00120 <span class="stringliteral">                            `"</span>.<a class="code" href="class_d_b_enseignant.html#6c582ad9ff477418bbbef1e17ae08717">DBEnseignant::$FIELD_MAIL_ENSEIGNANT</a>.<span class="stringliteral">"` VARCHAR(255) NULL default 'NULL' ,  </span>
<a name="l00121"></a>00121 <span class="stringliteral">                            `"</span>.<a class="code" href="class_d_b_enseignant.html#e00b44d718d8a8d6b3c2b67290399296">DBEnseignant::$FIELD_LOGIN_ENSEIGNANT</a>.<span class="stringliteral">"` VARCHAR(255) NULL default 'NULL' ,  </span>
<a name="l00122"></a>00122 <span class="stringliteral">                            `"</span>.<a class="code" href="class_d_b_enseignant.html#f3ac8a24bd1d759b935bebcf8795921d">DBEnseignant::$FIELD_PASSWORD_ENSEIGNANT</a>.<span class="stringliteral">"` BIGINT NULL default '0' ,  </span>
<a name="l00123"></a>00123 <span class="stringliteral">                            `"</span>.<a class="code" href="class_d_b_enseignant.html#51f7e4adfcf93cc501211ff00c832a76">DBEnseignant::$FIELD_DATE_DERNIERE_RECUPERATION_PASS</a>.<span class="stringliteral">"` DATETIME NULL  ,</span>
<a name="l00124"></a>00124 <span class="stringliteral">                                                        '"</span>.<a class="code" href="class_d_b_enseignant.html#2da62e115d9acc30823a0c5a66946ed7">DBEnseignant::$FIELD_STATUT_ENSEIGNANT</a>.<span class="stringliteral">"`  ENUM('"</span>
<a name="l00125"></a>00125                                                                                                 .DBEnseignant::$STATUT_ENSEIGNANT_ACTIF.<span class="stringliteral">"','"</span>
<a name="l00126"></a>00126                                                                                                 .DBEnseignant::$STATUT_ENSEIGNANT_PASSIF.<span class="stringliteral">"') NOT NULL default 'actif',</span>
<a name="l00127"></a>00127 <span class="stringliteral">                            PRIMARY KEY (`"</span>.<a class="code" href="class_d_b_enseignant.html#d686f05c5197c924b553eddda615b883">DBEnseignant::$FIELD_ID_ENSEIGNANT</a>.<span class="stringliteral">"`)</span>
<a name="l00128"></a>00128 <span class="stringliteral">                ) ENGINE=MyISAM DEFAULT CHARSET=latin1;"</span>;
<a name="l00129"></a>00129         
<a name="l00130"></a>00130         
<a name="l00131"></a>00131         foreach(explode(<span class="stringliteral">";"</span>, $sql) as $query)
<a name="l00132"></a>00132         {
<a name="l00133"></a>00133             <span class="keywordflow">if</span>($query != <span class="stringliteral">""</span>)
<a name="l00134"></a>00134                 <a class="code" href="class_d_b_connector.html#43db9aca89fd7bf7ecd0643174246776">DBConnector::getDBConnector</a>()-&gt;executeQuery($query);
<a name="l00135"></a>00135         }
<a name="l00136"></a>00136     }
<a name="l00137"></a>00137     
<a name="l00138"></a>00138         
<a name="l00151"></a><a class="code" href="class_d_b_enseignant.html#8b79b7f5e280b8a80f9d1c6449ec658d">00151</a>         <span class="keyword">public</span> <span class="keyword">static</span> function <a class="code" href="class_d_b_enseignant.html#8b79b7f5e280b8a80f9d1c6449ec658d">createRecord</a>($nomEnseignant, $prenomEnseignant, $mailEnseignant, $loginEnseignant, $passwordEnseignant, $dateDerniereRecuperationPass, $statutEnseignant){
<a name="l00152"></a>00152         $sql = <span class="stringliteral">"INSERT INTO "</span>.DBEnseignant::$TABLE_NAME.<span class="stringliteral">" ("</span>
<a name="l00153"></a>00153                             .DBEnseignant::$FIELD_NOM_ENSEIGNANT.<span class="stringliteral">", "</span>
<a name="l00154"></a>00154                             .DBEnseignant::$FIELD_PRENOM_ENSEIGNANT.<span class="stringliteral">", "</span>
<a name="l00155"></a>00155                             .DBEnseignant::$FIELD_MAIL_ENSEIGNANT.<span class="stringliteral">", "</span>
<a name="l00156"></a>00156                             .DBEnseignant::$FIELD_LOGIN_ENSEIGNANT.<span class="stringliteral">", "</span>
<a name="l00157"></a>00157                             .DBEnseignant::$FIELD_PASSWORD_ENSEIGNANT.<span class="stringliteral">", "</span>
<a name="l00158"></a>00158                             .DBEnseignant::$FIELD_DATE_DERNIERE_RECUPERATION_PASS.<span class="stringliteral">", "</span>
<a name="l00159"></a>00159                             .DBEnseignant::$FIELD_STATUT_ENSEIGNANT.<span class="stringliteral">" "</span>
<a name="l00160"></a>00160                             .<span class="stringliteral">") VALUES ("</span>
<a name="l00161"></a>00161                             .DBConnector::getDBConnector()-&gt;processString(<a class="code" href="class_d_b_connector.html#43db9aca89fd7bf7ecd0643174246776">DBConnector::getDBConnector</a>()-&gt;echapString($nomEnseignant)).<span class="stringliteral">", "</span>
<a name="l00162"></a>00162                             .DBConnector::getDBConnector()-&gt;processString(<a class="code" href="class_d_b_connector.html#43db9aca89fd7bf7ecd0643174246776">DBConnector::getDBConnector</a>()-&gt;echapString($prenomEnseignant)).<span class="stringliteral">", "</span>
<a name="l00163"></a>00163                             .DBConnector::getDBConnector()-&gt;processObject(DBConnector::getDBConnector()-&gt;echapString($mailEnseignant)).<span class="stringliteral">", "</span>
<a name="l00164"></a>00164                             .DBConnector::getDBConnector()-&gt;processObject(DBConnector::getDBConnector()-&gt;echapString($loginEnseignant)).<span class="stringliteral">", "</span>
<a name="l00165"></a>00165                             .DBConnector::getDBConnector()-&gt;processObject($passwordEnseignant).<span class="stringliteral">", "</span>
<a name="l00166"></a>00166                             .DBConnector::getDBConnector()-&gt;computeDateTime($dateDerniereRecuperationPass).<span class="stringliteral">", "</span>
<a name="l00167"></a>00167                             .DBConnector::getDBConnector()-&gt;processString(DBConnector::getDBConnector()-&gt;echapString($statutEnseignant)).<span class="stringliteral">" "</span>
<a name="l00168"></a>00168                             .<span class="stringliteral">")"</span>;
<a name="l00169"></a>00169         
<a name="l00170"></a>00170         $id = <a class="code" href="class_d_b_connector.html#43db9aca89fd7bf7ecd0643174246776">DBConnector::getDBConnector</a>()-&gt;executeQuery($sql);
<a name="l00171"></a>00171         
<a name="l00172"></a>00172         $obj = <a class="code" href="class_d_b_enseignant.html#ef71d34e42385466cc2da38e33a1826d">DBEnseignant::getRecords</a>($id);
<a name="l00173"></a>00173         assert(count($obj) == 1);
<a name="l00174"></a>00174         <span class="keywordflow">return</span> $obj[0];
<a name="l00175"></a>00175     }
<a name="l00176"></a>00176     
<a name="l00177"></a>00177         
<a name="l00191"></a><a class="code" href="class_d_b_enseignant.html#ef71d34e42385466cc2da38e33a1826d">00191</a>         <span class="keyword">public</span> <span class="keyword">static</span> function <a class="code" href="class_d_b_enseignant.html#ef71d34e42385466cc2da38e33a1826d">getRecords</a>($idEnseignant=<span class="stringliteral">""</span>, $nomEnseignant=<span class="stringliteral">""</span>, $prenomEnseignant=<span class="stringliteral">""</span>, $mailEnseignant=<span class="stringliteral">""</span>, $loginEnseignant=<span class="stringliteral">""</span>, $passwordEnseignant=<span class="stringliteral">""</span>, $dateDerniereRecuperationPass=<span class="stringliteral">""</span>, $statutEnseignant=<span class="stringliteral">""</span>){
<a name="l00192"></a>00192         $sql = <span class="stringliteral">"SELECT * FROM "</span>.DBEnseignant::$TABLE_NAME.<span class="stringliteral">" WHERE 1"</span>;
<a name="l00193"></a>00193         
<a name="l00194"></a>00194         <span class="keywordflow">if</span>($idEnseignant != <span class="stringliteral">""</span>)
<a name="l00195"></a>00195             $sql .= <span class="stringliteral">" AND "</span>.DBEnseignant::$FIELD_ID_ENSEIGNANT.<span class="stringliteral">"="</span>.<a class="code" href="class_d_b_connector.html#43db9aca89fd7bf7ecd0643174246776">DBConnector::getDBConnector</a>()-&gt;processInt($idEnseignant);
<a name="l00196"></a>00196         <span class="keywordflow">if</span>($nomEnseignant != <span class="stringliteral">""</span>)
<a name="l00197"></a>00197             $sql .= <span class="stringliteral">" AND "</span>.DBEnseignant::$FIELD_NOM_ENSEIGNANT.<span class="stringliteral">"="</span>.<a class="code" href="class_d_b_connector.html#43db9aca89fd7bf7ecd0643174246776">DBConnector::getDBConnector</a>()-&gt;processString(<a class="code" href="class_d_b_connector.html#43db9aca89fd7bf7ecd0643174246776">DBConnector::getDBConnector</a>()-&gt;echapString($nomEnseignant));
<a name="l00198"></a>00198         <span class="keywordflow">if</span>($prenomEnseignant != <span class="stringliteral">""</span>)
<a name="l00199"></a>00199             $sql .= <span class="stringliteral">" AND "</span>.DBEnseignant::$FIELD_PRENOM_ENSEIGNANT.<span class="stringliteral">"="</span>.<a class="code" href="class_d_b_connector.html#43db9aca89fd7bf7ecd0643174246776">DBConnector::getDBConnector</a>()-&gt;processString(<a class="code" href="class_d_b_connector.html#43db9aca89fd7bf7ecd0643174246776">DBConnector::getDBConnector</a>()-&gt;echapString($prenomEnseignant));
<a name="l00200"></a>00200         <span class="keywordflow">if</span>($mailEnseignant != <span class="stringliteral">""</span>)
<a name="l00201"></a>00201             $sql .= <span class="stringliteral">" AND "</span>.DBEnseignant::$FIELD_MAIL_ENSEIGNANT.<span class="stringliteral">"="</span>.<a class="code" href="class_d_b_connector.html#43db9aca89fd7bf7ecd0643174246776">DBConnector::getDBConnector</a>()-&gt;processObject(<a class="code" href="class_d_b_connector.html#43db9aca89fd7bf7ecd0643174246776">DBConnector::getDBConnector</a>()-&gt;echapString($mailEnseignant));
<a name="l00202"></a>00202         <span class="keywordflow">if</span>($loginEnseignant != <span class="stringliteral">""</span>)
<a name="l00203"></a>00203             $sql .= <span class="stringliteral">" AND "</span>.DBEnseignant::$FIELD_LOGIN_ENSEIGNANT.<span class="stringliteral">"="</span>.<a class="code" href="class_d_b_connector.html#43db9aca89fd7bf7ecd0643174246776">DBConnector::getDBConnector</a>()-&gt;processObject(<a class="code" href="class_d_b_connector.html#43db9aca89fd7bf7ecd0643174246776">DBConnector::getDBConnector</a>()-&gt;echapString($loginEnseignant));
<a name="l00204"></a>00204         <span class="keywordflow">if</span>($passwordEnseignant != <span class="stringliteral">""</span>)
<a name="l00205"></a>00205             $sql .= <span class="stringliteral">" AND "</span>.DBEnseignant::$FIELD_PASSWORD_ENSEIGNANT.<span class="stringliteral">"="</span>.<a class="code" href="class_d_b_connector.html#43db9aca89fd7bf7ecd0643174246776">DBConnector::getDBConnector</a>()-&gt;processObject($passwordEnseignant);
<a name="l00206"></a>00206         <span class="keywordflow">if</span>($dateDerniereRecuperationPass != <span class="stringliteral">""</span>)
<a name="l00207"></a>00207             $sql .= <span class="stringliteral">" AND "</span>.DBEnseignant::$FIELD_DATE_DERNIERE_RECUPERATION_PASS.<span class="stringliteral">"="</span>.<a class="code" href="class_d_b_connector.html#43db9aca89fd7bf7ecd0643174246776">DBConnector::getDBConnector</a>()-&gt;computeDateTime($dateDerniereRecuperationPass);
<a name="l00208"></a>00208         <span class="keywordflow">if</span>($statutEnseignant != <span class="stringliteral">""</span>)
<a name="l00209"></a>00209             $sql .= <span class="stringliteral">" AND "</span>.DBEnseignant::$FIELD_STATUT_ENSEIGNANT.<span class="stringliteral">"="</span>.<a class="code" href="class_d_b_connector.html#43db9aca89fd7bf7ecd0643174246776">DBConnector::getDBConnector</a>()-&gt;processString(<a class="code" href="class_d_b_connector.html#43db9aca89fd7bf7ecd0643174246776">DBConnector::getDBConnector</a>()-&gt;echapString($statutEnseignant));
<a name="l00210"></a>00210                         
<a name="l00211"></a>00211         $res = <a class="code" href="class_d_b_connector.html#43db9aca89fd7bf7ecd0643174246776">DBConnector::getDBConnector</a>()-&gt;executeQuery($sql);
<a name="l00212"></a>00212         
<a name="l00213"></a>00213         $return = array();
<a name="l00214"></a>00214         $i=0;
<a name="l00215"></a>00215         <span class="keywordflow">while</span>($result = <a class="code" href="class_d_b_connector.html#43db9aca89fd7bf7ecd0643174246776">DBConnector::getDBConnector</a>()-&gt;fetchArray($res))
<a name="l00216"></a>00216         {
<a name="l00217"></a>00217             $return[$i] = <span class="keyword">new</span> <a class="code" href="class_d_b_enseignant.html">DBEnseignant</a>(
<a name="l00218"></a>00218                                             $result[<a class="code" href="class_d_b_enseignant.html#d686f05c5197c924b553eddda615b883">DBEnseignant::$FIELD_ID_ENSEIGNANT</a>],
<a name="l00219"></a>00219                                             $result[<a class="code" href="class_d_b_enseignant.html#4e36abee585f222ca7c4084a562abd98">DBEnseignant::$FIELD_NOM_ENSEIGNANT</a>],
<a name="l00220"></a>00220                                             $result[<a class="code" href="class_d_b_enseignant.html#f2f782c543fab1af1ebc32228e236a42">DBEnseignant::$FIELD_PRENOM_ENSEIGNANT</a>],
<a name="l00221"></a>00221                                             $result[<a class="code" href="class_d_b_enseignant.html#6c582ad9ff477418bbbef1e17ae08717">DBEnseignant::$FIELD_MAIL_ENSEIGNANT</a>],
<a name="l00222"></a>00222                                             $result[<a class="code" href="class_d_b_enseignant.html#e00b44d718d8a8d6b3c2b67290399296">DBEnseignant::$FIELD_LOGIN_ENSEIGNANT</a>],
<a name="l00223"></a>00223                                             $result[<a class="code" href="class_d_b_enseignant.html#f3ac8a24bd1d759b935bebcf8795921d">DBEnseignant::$FIELD_PASSWORD_ENSEIGNANT</a>],
<a name="l00224"></a>00224                                             <a class="code" href="class_d_b_connector.html#43db9aca89fd7bf7ecd0643174246776">DBConnector::getDBConnector</a>()-&gt;decomputeDateTime($result[<a class="code" href="class_d_b_enseignant.html#51f7e4adfcf93cc501211ff00c832a76">DBEnseignant::$FIELD_DATE_DERNIERE_RECUPERATION_PASS</a>]),
<a name="l00225"></a>00225                                                                                         $result[<a class="code" href="class_d_b_enseignant.html#2da62e115d9acc30823a0c5a66946ed7">DBEnseignant::$FIELD_STATUT_ENSEIGNANT</a>]
<a name="l00226"></a>00226                                         );
<a name="l00227"></a>00227             
<a name="l00228"></a>00228             $i++;
<a name="l00229"></a>00229         }
<a name="l00230"></a>00230         
<a name="l00231"></a>00231         <span class="keywordflow">return</span> $return;
<a name="l00232"></a>00232     }
<a name="l00233"></a>00233     
<a name="l00234"></a>00234         
<a name="l00246"></a><a class="code" href="class_d_b_enseignant.html#df2067e79a0fd60edf2894e9dfd4f2d8">00246</a>         <span class="keyword">public</span>  function <a class="code" href="class_d_b_enseignant.html#df2067e79a0fd60edf2894e9dfd4f2d8">updateRecord</a>($nomEnseignant, $prenomEnseignant, $mailEnseignant, $loginEnseignant, $passwordEnseignant, $dateDerniereRecuperationPass, $statutEnseignant){
<a name="l00247"></a>00247         $sql = <span class="stringliteral">"UPDATE "</span>.DBEnseignant::$TABLE_NAME.<span class="stringliteral">" SET "</span>;
<a name="l00248"></a>00248         $sql .= <a class="code" href="class_d_b_enseignant.html#4e36abee585f222ca7c4084a562abd98">DBEnseignant::$FIELD_NOM_ENSEIGNANT</a>.<span class="stringliteral">"="</span>.<a class="code" href="class_d_b_connector.html#43db9aca89fd7bf7ecd0643174246776">DBConnector::getDBConnector</a>()-&gt;processString(<a class="code" href="class_d_b_connector.html#43db9aca89fd7bf7ecd0643174246776">DBConnector::getDBConnector</a>()-&gt;echapString($nomEnseignant)).<span class="stringliteral">","</span>;
<a name="l00249"></a>00249         $sql .= <a class="code" href="class_d_b_enseignant.html#f2f782c543fab1af1ebc32228e236a42">DBEnseignant::$FIELD_PRENOM_ENSEIGNANT</a>.<span class="stringliteral">"="</span>.<a class="code" href="class_d_b_connector.html#43db9aca89fd7bf7ecd0643174246776">DBConnector::getDBConnector</a>()-&gt;processString(<a class="code" href="class_d_b_connector.html#43db9aca89fd7bf7ecd0643174246776">DBConnector::getDBConnector</a>()-&gt;echapString($prenomEnseignant)).<span class="stringliteral">","</span>;
<a name="l00250"></a>00250         $sql .= <a class="code" href="class_d_b_enseignant.html#6c582ad9ff477418bbbef1e17ae08717">DBEnseignant::$FIELD_MAIL_ENSEIGNANT</a>.<span class="stringliteral">"="</span>.<a class="code" href="class_d_b_connector.html#43db9aca89fd7bf7ecd0643174246776">DBConnector::getDBConnector</a>()-&gt;processObject(<a class="code" href="class_d_b_connector.html#43db9aca89fd7bf7ecd0643174246776">DBConnector::getDBConnector</a>()-&gt;echapString($mailEnseignant)).<span class="stringliteral">","</span>;
<a name="l00251"></a>00251         $sql .= <a class="code" href="class_d_b_enseignant.html#e00b44d718d8a8d6b3c2b67290399296">DBEnseignant::$FIELD_LOGIN_ENSEIGNANT</a>.<span class="stringliteral">"="</span>.<a class="code" href="class_d_b_connector.html#43db9aca89fd7bf7ecd0643174246776">DBConnector::getDBConnector</a>()-&gt;processObject(<a class="code" href="class_d_b_connector.html#43db9aca89fd7bf7ecd0643174246776">DBConnector::getDBConnector</a>()-&gt;echapString($loginEnseignant)).<span class="stringliteral">","</span>;
<a name="l00252"></a>00252         $sql .= <a class="code" href="class_d_b_enseignant.html#f3ac8a24bd1d759b935bebcf8795921d">DBEnseignant::$FIELD_PASSWORD_ENSEIGNANT</a>.<span class="stringliteral">"="</span>.<a class="code" href="class_d_b_connector.html#43db9aca89fd7bf7ecd0643174246776">DBConnector::getDBConnector</a>()-&gt;processObject($passwordEnseignant).<span class="stringliteral">","</span>;
<a name="l00253"></a>00253         $sql .= <a class="code" href="class_d_b_enseignant.html#51f7e4adfcf93cc501211ff00c832a76">DBEnseignant::$FIELD_DATE_DERNIERE_RECUPERATION_PASS</a>.<span class="stringliteral">"="</span>.<a class="code" href="class_d_b_connector.html#43db9aca89fd7bf7ecd0643174246776">DBConnector::getDBConnector</a>()-&gt;computeDateTime($dateDerniereRecuperationPass).<span class="stringliteral">","</span>;
<a name="l00254"></a>00254         $sql .= <a class="code" href="class_d_b_enseignant.html#2da62e115d9acc30823a0c5a66946ed7">DBEnseignant::$FIELD_STATUT_ENSEIGNANT</a>.<span class="stringliteral">"="</span>.<a class="code" href="class_d_b_connector.html#43db9aca89fd7bf7ecd0643174246776">DBConnector::getDBConnector</a>()-&gt;processString(<a class="code" href="class_d_b_connector.html#43db9aca89fd7bf7ecd0643174246776">DBConnector::getDBConnector</a>()-&gt;echapString($statutEnseignant)).<span class="stringliteral">""</span>;
<a name="l00255"></a>00255         
<a name="l00256"></a>00256         $sql .= <span class="stringliteral">" WHERE 1"</span>;
<a name="l00257"></a>00257         $sql .= <span class="stringliteral">" AND "</span>.DBEnseignant::$FIELD_ID_ENSEIGNANT.<span class="stringliteral">"="</span>.<a class="code" href="class_d_b_connector.html#43db9aca89fd7bf7ecd0643174246776">DBConnector::getDBConnector</a>()-&gt;processInt($this-&gt;_idEnseignant);
<a name="l00258"></a>00258         
<a name="l00259"></a>00259         <a class="code" href="class_d_b_connector.html#43db9aca89fd7bf7ecd0643174246776">DBConnector::getDBConnector</a>()-&gt;executeQuery($sql);
<a name="l00260"></a>00260         
<a name="l00261"></a>00261         $this-&gt;_nomEnseignant = <a class="code" href="class_d_b_connector.html#43db9aca89fd7bf7ecd0643174246776">DBConnector::getDBConnector</a>()-&gt;echapString($nomEnseignant);
<a name="l00262"></a>00262         $this-&gt;_prenomEnseignant = <a class="code" href="class_d_b_connector.html#43db9aca89fd7bf7ecd0643174246776">DBConnector::getDBConnector</a>()-&gt;echapString($prenomEnseignant);
<a name="l00263"></a>00263         $this-&gt;_mailEnseignant = <a class="code" href="class_d_b_connector.html#43db9aca89fd7bf7ecd0643174246776">DBConnector::getDBConnector</a>()-&gt;echapString($mailEnseignant);
<a name="l00264"></a>00264         $this-&gt;_loginEnseignant = <a class="code" href="class_d_b_connector.html#43db9aca89fd7bf7ecd0643174246776">DBConnector::getDBConnector</a>()-&gt;echapString($loginEnseignant);
<a name="l00265"></a>00265         $this-&gt;_passwordEnseignant = $passwordEnseignant;
<a name="l00266"></a>00266         $this-&gt;_dateDerniereRecuperationPass = $dateDerniereRecuperationPass;
<a name="l00267"></a>00267         $this-&gt;_statutEnseignant = $statutEnseignant;
<a name="l00268"></a>00268     }
<a name="l00269"></a>00269     
<a name="l00270"></a>00270         
<a name="l00275"></a><a class="code" href="class_d_b_enseignant.html#32468324bc01d8174be13fed681e1a32">00275</a>         <span class="keyword">public</span>  function <a class="code" href="class_d_b_enseignant.html#32468324bc01d8174be13fed681e1a32">deleteRecord</a>(){
<a name="l00276"></a>00276         $sql = <span class="stringliteral">"DELETE FROM "</span>.DBEnseignant::$TABLE_NAME.<span class="stringliteral">" WHERE 1"</span>;
<a name="l00277"></a>00277         $sql .= <span class="stringliteral">" AND "</span>.DBEnseignant::$FIELD_ID_ENSEIGNANT.<span class="stringliteral">"="</span>.<a class="code" href="class_d_b_connector.html#43db9aca89fd7bf7ecd0643174246776">DBConnector::getDBConnector</a>()-&gt;processInt($this-&gt;_idEnseignant);
<a name="l00278"></a>00278         
<a name="l00279"></a>00279         <a class="code" href="class_d_b_connector.html#43db9aca89fd7bf7ecd0643174246776">DBConnector::getDBConnector</a>()-&gt;executeQuery($sql);
<a name="l00280"></a>00280     }
<a name="l00281"></a>00281     
<a name="l00282"></a>00282         
<a name="l00290"></a><a class="code" href="class_d_b_enseignant.html#8f4ca6076863650ecc75f704af3785be">00290</a>     <span class="keyword">public</span> <span class="keyword">static</span> function <a class="code" href="class_d_b_enseignant.html#8f4ca6076863650ecc75f704af3785be">authEnseignant</a>($id,$mdp){
<a name="l00291"></a>00291         $enseignants = <a class="code" href="class_d_b_enseignant.html#ef71d34e42385466cc2da38e33a1826d">DBEnseignant::getRecords</a>($id, <span class="stringliteral">""</span>, <span class="stringliteral">""</span>, <span class="stringliteral">""</span>, <span class="stringliteral">""</span>, $mdp);
<a name="l00292"></a>00292         <span class="keywordflow">if</span> (count($enseignants)== 1)
<a name="l00293"></a>00293                 <span class="keywordflow">return</span> $enseignants[0];
<a name="l00294"></a>00294         <span class="keywordflow">else</span>
<a name="l00295"></a>00295                 <span class="keywordflow">return</span> NULL;
<a name="l00296"></a>00296     } 
<a name="l00297"></a>00297     
<a name="l00298"></a>00298         
<a name="l00304"></a><a class="code" href="class_d_b_enseignant.html#6a3e8522736d7e5fc634843f184b475f">00304</a>     <span class="keyword">public</span> function <a class="code" href="class_d_b_enseignant.html#6a3e8522736d7e5fc634843f184b475f">getFormSelectOptionLabel</a>(){
<a name="l00305"></a>00305         <span class="keywordflow">return</span> $this-&gt;<a class="code" href="class_d_b_enseignant.html#6d8941ff4dbd88c078f09aede0daed6f">getNomEnseignant</a>().<span class="stringliteral">" "</span>.$this-&gt;<a class="code" href="class_d_b_enseignant.html#05f5192dab3255ba348bf9712a3d3003">getPrenomEnseignant</a>();
<a name="l00306"></a>00306     }
<a name="l00307"></a>00307     
<a name="l00308"></a>00308         
<a name="l00314"></a><a class="code" href="class_d_b_enseignant.html#e87994f709f2500317a3fcb6ff73dda4">00314</a>         <span class="keyword">public</span> function <a class="code" href="class_d_b_enseignant.html#e87994f709f2500317a3fcb6ff73dda4">getFormSelectOptionValue</a>(){
<a name="l00315"></a>00315         <span class="keywordflow">return</span> $this-&gt;<a class="code" href="class_d_b_enseignant.html#51b6e640a24219a654fd84dacf87a628">getIdEnseignant</a>();
<a name="l00316"></a>00316     }
<a name="l00317"></a>00317     
<a name="l00318"></a>00318         
<a name="l00319"></a>00319         
<a name="l00326"></a><a class="code" href="class_d_b_enseignant.html#b56beb9c0b1078d42674b9097ebb2882">00326</a>     <span class="keyword">public</span> function <a class="code" href="class_d_b_enseignant.html#b56beb9c0b1078d42674b9097ebb2882">sendPass</a>($sendMailToAdminIfNoMailFound=<span class="keyword">true</span>){
<a name="l00327"></a>00327         <span class="comment">// On vérifie d'abord si le dernier mail n'a pas été envoyé trop récemment</span>
<a name="l00328"></a>00328         <span class="keywordflow">if</span>(($this-&gt;_dateDerniereRecuperationPass != null) &amp;&amp; (time() - formattedDateTimeToTime($this-&gt;_dateDerniereRecuperationPass) &lt; <a class="code" href="class_d_b_config.html#7e66dfa5143f057ff66c73cbbe3eeb65">DBConfig::getConfigValue</a>(<span class="stringliteral">"LIMITE SECONDES ENVOI MAIL"</span>)))
<a name="l00329"></a>00329             <span class="keywordflow">return</span> <span class="stringliteral">"Erreur : cela fait trop peu de temps que vous avez demandé votre mot de passe !"</span>;
<a name="l00330"></a>00330         <span class="keywordflow">else</span>{
<a name="l00331"></a>00331 
<a name="l00332"></a>00332             <span class="comment">// On regarde si l'adresse est valable... Si ce n'est pas le cas, on mail le responsable des stages pour lui communiquer la demande de mail</span>
<a name="l00333"></a>00333             <span class="comment">// et on demandera à l'utilisateur de mailer le maitre de stage</span>
<a name="l00334"></a>00334             <span class="keywordflow">if</span>(($this-&gt;_mailEnseignant == <span class="stringliteral">""</span>) &amp;&amp; $sendMailToAdminIfNoMailFound){
<a name="l00335"></a>00335                 $m = <span class="keyword">new</span> <a class="code" href="class_mailer.html">Mailer</a>(<a class="code" href="class_d_b_enseignant.html#c7c6996ddd2c08896307d797aefe5cc2">DBEnseignant::$MAILPASSADMIN_TEMPLATE</a>);
<a name="l00336"></a>00336                 $m-&gt;fillTemplateVar(<span class="stringliteral">"nom_enseignant"</span>, $this-&gt;_nomEnseignant);
<a name="l00337"></a>00337                 $m-&gt;fillTemplateVar(<span class="stringliteral">"prenom_enseignant"</span>, $this-&gt;_prenomEnseignant);
<a name="l00338"></a>00338                 $m-&gt;fillTemplateVar(<span class="stringliteral">"mot_de_passe"</span>, $this-&gt;_passwordEnseignant);
<a name="l00339"></a>00339                 
<a name="l00340"></a>00340                 <span class="keywordflow">if</span>(!$m-&gt;sendMail(<a class="code" href="class_d_b_config.html#7e66dfa5143f057ff66c73cbbe3eeb65">DBConfig::getConfigValue</a>(<span class="stringliteral">"MAIL ADMINISTRATEURS"</span>), <span class="stringliteral">"stages_miage@miage.emi.u-bordeaux1.fr"</span>, <a class="code" href="class_d_b_config.html#7e66dfa5143f057ff66c73cbbe3eeb65">DBConfig::getConfigValue</a>(<span class="stringliteral">"MAIL ADMINISTRATEURS"</span>), <span class="stringliteral">"Site MIAGe des stages : Mot de passe de "</span>.$this-&gt;_nomEnseignant.<span class="stringliteral">" "</span>.$this-&gt;_prenomEnseignant))
<a name="l00341"></a>00341                     <span class="keywordflow">return</span> <span class="stringliteral">"Erreur lors de l'envoi de mail à l'administrateur !"</span>;
<a name="l00342"></a>00342                 <span class="keywordflow">else</span>
<a name="l00343"></a>00343                     <span class="keywordflow">return</span> <span class="stringliteral">"Aucune adresse n'est disponible dans la base vous concernant. L'administrateur du site a été notifié de votre demande de mot de passe. Vous pouvez le contacter pour récupérer votre mot de passe."</span>;
<a name="l00344"></a>00344             }
<a name="l00345"></a>00345             <span class="comment">// Si le mail est valide</span>
<a name="l00346"></a>00346             <span class="keywordflow">else</span> <span class="keywordflow">if</span>($this-&gt;_mailEnseignant != <span class="stringliteral">""</span>){
<a name="l00347"></a>00347                 $m = <span class="keyword">new</span> <a class="code" href="class_mailer.html">Mailer</a>(<a class="code" href="class_d_b_enseignant.html#31e4cfbcb984a80a8440a65aa7419bb4">DBEnseignant::$MAILPASS_TEMPLATE</a>);
<a name="l00348"></a>00348                 $m-&gt;fillTemplateVar(<span class="stringliteral">"nom_enseignant"</span>, $this-&gt;_nomEnseignant);
<a name="l00349"></a>00349                 $m-&gt;fillTemplateVar(<span class="stringliteral">"prenom_enseignant"</span>, $this-&gt;_prenomEnseignant);
<a name="l00350"></a>00350                 $m-&gt;fillTemplateVar(<span class="stringliteral">"mot_de_passe"</span>, $this-&gt;_passwordEnseignant);
<a name="l00351"></a>00351                 
<a name="l00352"></a>00352                 $ok = <span class="keyword">true</span>;
<a name="l00353"></a>00353                 $ok = ($ok &amp;&amp; $m-&gt;sendMail($this-&gt;_mailEnseignant, <span class="stringliteral">"stages_miage@miage.emi.u-bordeaux1.fr"</span>, <a class="code" href="class_d_b_config.html#7e66dfa5143f057ff66c73cbbe3eeb65">DBConfig::getConfigValue</a>(<span class="stringliteral">"MAIL ADMINISTRATEURS"</span>), <span class="stringliteral">"Site MIAGe des stages : Récupération de mot de passe"</span>));
<a name="l00354"></a>00354 
<a name="l00355"></a>00355                 <span class="comment">// Mise a jour de la date de dernier envoi</span>
<a name="l00356"></a>00356                 $this-&gt;_dateDerniereRecuperationPass = timeToFormattedDateTime(time());
<a name="l00357"></a>00357                 $this-&gt;<a class="code" href="class_d_b_enseignant.html#df2067e79a0fd60edf2894e9dfd4f2d8">updateRecord</a>($this-&gt;_nomEnseignant, $this-&gt;_prenomEnseignant, $this-&gt;_mailEnseignant, $this-&gt;_loginEnseignant, $this-&gt;_passwordEnseignant, $this-&gt;_dateDerniereRecuperationPass);
<a name="l00358"></a>00358 
<a name="l00359"></a>00359                 <span class="keywordflow">if</span>(!$ok)
<a name="l00360"></a>00360                     <span class="keywordflow">return</span> <span class="stringliteral">"Erreur lors de l'envoi d'au moins un stage !"</span>;
<a name="l00361"></a>00361                 
<a name="l00362"></a>00362                 <span class="keywordflow">return</span> <span class="stringliteral">""</span>;
<a name="l00363"></a>00363             }
<a name="l00364"></a>00364         }
<a name="l00365"></a>00365     }
<a name="l00366"></a>00366 }
<a name="l00367"></a>00367 ?&gt;
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Wed Mar 28 11:48:05 2007 for Stage by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.1-p1 </small></address>
</body>
</html>
