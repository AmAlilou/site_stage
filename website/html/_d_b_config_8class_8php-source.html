<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>Stage: D:/developpement/php/www/Stage/trunk/class/DBClasses/DBConfig.class.php Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.1-p1 -->
<div class="tabs">
  <ul>
    <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
    <li><a href="namespaces.html"><span>Namespaces</span></a></li>
    <li><a href="annotated.html"><span>Classes</span></a></li>
    <li id="current"><a href="files.html"><span>Files</span></a></li>
    <li>
      <form action="search.php" method="get">
        <table cellspacing="0" cellpadding="0" border="0">
          <tr>
            <td><label>&nbsp;<u>S</u>earch&nbsp;for&nbsp;</label></td>
            <td><input type="text" name="query" value="" size="20" accesskey="s"/></td>
          </tr>
        </table>
      </form>
    </li>
  </ul></div>
<h1>D:/developpement/php/www/Stage/trunk/class/DBClasses/DBConfig.class.php</h1><a href="_d_b_config_8class_8php.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 &lt;?php
<a name="l00002"></a>00002 set_include_path(<span class="stringliteral">"."</span>.PATH_SEPARATOR.<span class="stringliteral">".."</span>.PATH_SEPARATOR.<span class="stringliteral">"../.."</span>);
<a name="l00003"></a>00003 <span class="keywordflow">if</span>(!isset($ROOT_PATH))
<a name="l00004"></a>00004 require_once(<span class="stringliteral">"inc/main.inc.php"</span>);
<a name="l00005"></a>00005 
<a name="l00006"></a>00006 <span class="comment">// Généré via PHPClassGenerator via l'url index.php?nb_champs=2&amp;nom_table=config&amp;nom_champ_1=nom_variable&amp;type_champ_1=1&amp;taille_champ_1=128&amp;champ_facultatif_1=&amp;valeur_defaut_1=&amp;auto_increment_1=&amp;clef_primaire_1=on&amp;getter_1=&amp;setter_1=&amp;nom_champ_2=valeur_variable&amp;type_champ_2=2&amp;taille_champ_2=&amp;champ_facultatif_2=&amp;valeur_defaut_2=&amp;auto_increment_2=&amp;clef_primaire_2=&amp;getter_2=on&amp;setter_2=</span>
<a name="l00007"></a>00007 
<a name="l00012"></a><a class="code" href="class_d_b_config.html">00012</a>  <span class="keyword">class </span><a class="code" href="class_d_b_config.html">DBConfig</a> {
<a name="l00013"></a><a class="code" href="class_d_b_config.html#0222f3527c5ac1f6f336c4c2c24b79ca">00013</a>     <span class="keyword">private</span> <span class="keyword">static</span> <a class="code" href="class_d_b_config.html#0222f3527c5ac1f6f336c4c2c24b79ca">$TABLE_NAME</a> = <span class="stringliteral">"config"</span>;
<a name="l00014"></a><a class="code" href="class_d_b_config.html#190da17a1066fe90a91e999a7135dd51">00014</a>     <span class="keyword">private</span> <span class="keyword">static</span> <a class="code" href="class_d_b_config.html#190da17a1066fe90a91e999a7135dd51">$FIELD_NOM_VARIABLE</a> = <span class="stringliteral">"nom_variable"</span>;
<a name="l00015"></a><a class="code" href="class_d_b_config.html#82636376c149716f62919659cf921576">00015</a>     <span class="keyword">private</span> <span class="keyword">static</span> <a class="code" href="class_d_b_config.html#82636376c149716f62919659cf921576">$FIELD_VALEUR_VARIABLE</a> = <span class="stringliteral">"valeur_variable"</span>;
<a name="l00016"></a>00016 
<a name="l00017"></a><a class="code" href="class_d_b_config.html#c7eec3ed9bc84e34b37b7408cd92950b">00017</a>     <span class="keyword">private</span> <a class="code" href="class_d_b_config.html#c7eec3ed9bc84e34b37b7408cd92950b">$_nomVariable</a>;
<a name="l00018"></a><a class="code" href="class_d_b_config.html#daffab26a3f59a1c1e28bf2293a3dc56">00018</a>     <span class="keyword">private</span> <a class="code" href="class_d_b_config.html#daffab26a3f59a1c1e28bf2293a3dc56">$_valeurVariable</a>;
<a name="l00019"></a>00019 
<a name="l00020"></a>00020     <span class="comment">// A MODIFIER "a la main" lorsqu'on rajoute des valeurs dans la table config</span>
<a name="l00021"></a><a class="code" href="class_d_b_config.html#a560398ab83ab49c541fd54189c8deaf">00021</a>     <span class="keyword">private</span> <span class="keyword">static</span> <a class="code" href="class_d_b_config.html#a560398ab83ab49c541fd54189c8deaf">$NB_CONFIG_VALUES</a> = 15;
<a name="l00022"></a>00022 
<a name="l00029"></a><a class="code" href="class_d_b_config.html#35c06f6fc4e6fd532794c925fdd7d875">00029</a>     <span class="keyword">private</span>  function <a class="code" href="class_d_b_config.html#35c06f6fc4e6fd532794c925fdd7d875">__construct</a>($nomVariable, $valeurVariable){
<a name="l00030"></a>00030         $this-&gt;_nomVariable = $nomVariable;
<a name="l00031"></a>00031         $this-&gt;_valeurVariable = $valeurVariable;
<a name="l00032"></a>00032     }
<a name="l00033"></a>00033         
<a name="l00039"></a><a class="code" href="class_d_b_config.html#99a55aa1d16d8d45460d29a189eabd1a">00039</a>     <span class="keyword">public</span>  function <a class="code" href="class_d_b_config.html#99a55aa1d16d8d45460d29a189eabd1a">getValeurVariable</a>(){
<a name="l00040"></a>00040         <span class="keywordflow">return</span> $this-&gt;_valeurVariable;
<a name="l00041"></a>00041     }
<a name="l00042"></a>00042         
<a name="l00048"></a><a class="code" href="class_d_b_config.html#471c2b63da2f8e3f43cf08837c1e4a4f">00048</a>     <span class="keyword">public</span> <span class="keyword">static</span> function <a class="code" href="class_d_b_config.html#471c2b63da2f8e3f43cf08837c1e4a4f">tableExists</a>(){
<a name="l00049"></a>00049         $tableExists = <a class="code" href="class_d_b_connector.html#43db9aca89fd7bf7ecd0643174246776">DBConnector::getDBConnector</a>()-&gt;tableExists(<a class="code" href="class_d_b_config.html#0222f3527c5ac1f6f336c4c2c24b79ca">DBConfig::$TABLE_NAME</a>);
<a name="l00050"></a>00050         <span class="keywordflow">if</span>($tableExists)
<a name="l00051"></a>00051             $countOK = (count(<a class="code" href="class_d_b_config.html#c27b363e32cdb69643d9cbf29e3e6a9b">DBConfig::getRecords</a>()) == <a class="code" href="class_d_b_config.html#a560398ab83ab49c541fd54189c8deaf">DBConfig::$NB_CONFIG_VALUES</a>);
<a name="l00052"></a>00052         <span class="keywordflow">else</span>
<a name="l00053"></a>00053             $countOK = <span class="keyword">false</span>;
<a name="l00054"></a>00054         <span class="keywordflow">return</span> ($tableExists &amp;&amp; $countOK);
<a name="l00055"></a>00055     }
<a name="l00056"></a>00056         
<a name="l00061"></a><a class="code" href="class_d_b_config.html#9e1c41a7a14252e21f65ba5e210722fb">00061</a>     <span class="keyword">public</span> <span class="keyword">static</span> function <a class="code" href="class_d_b_config.html#9e1c41a7a14252e21f65ba5e210722fb">createTable</a>(){
<a name="l00062"></a>00062         <span class="keywordflow">if</span>(!<a class="code" href="class_d_b_connector.html#43db9aca89fd7bf7ecd0643174246776">DBConnector::getDBConnector</a>()-&gt;<a class="code" href="class_d_b_config.html#471c2b63da2f8e3f43cf08837c1e4a4f">tableExists</a>(<a class="code" href="class_d_b_config.html#0222f3527c5ac1f6f336c4c2c24b79ca">DBConfig::$TABLE_NAME</a>))
<a name="l00063"></a>00063         {
<a name="l00064"></a>00064             $sql = <span class="stringliteral">"CREATE TABLE `"</span>.DBConfig::$TABLE_NAME.<span class="stringliteral">"` (  </span>
<a name="l00065"></a>00065 <span class="stringliteral">                                `"</span>.<a class="code" href="class_d_b_config.html#190da17a1066fe90a91e999a7135dd51">DBConfig::$FIELD_NOM_VARIABLE</a>.<span class="stringliteral">"` VARCHAR(128) NOT NULL  ,  </span>
<a name="l00066"></a>00066 <span class="stringliteral">                                `"</span>.<a class="code" href="class_d_b_config.html#82636376c149716f62919659cf921576">DBConfig::$FIELD_VALEUR_VARIABLE</a>.<span class="stringliteral">"` TEXT NOT NULL  ,</span>
<a name="l00067"></a>00067 <span class="stringliteral">                                PRIMARY KEY (`"</span>.<a class="code" href="class_d_b_config.html#190da17a1066fe90a91e999a7135dd51">DBConfig::$FIELD_NOM_VARIABLE</a>.<span class="stringliteral">"`)</span>
<a name="l00068"></a>00068 <span class="stringliteral">                    ) ENGINE=MyISAM DEFAULT CHARSET=latin1;"</span>;
<a name="l00069"></a>00069             
<a name="l00070"></a>00070             
<a name="l00071"></a>00071             foreach(explode(<span class="stringliteral">";"</span>, $sql) as $query)
<a name="l00072"></a>00072             {
<a name="l00073"></a>00073                 <span class="keywordflow">if</span>($query != <span class="stringliteral">""</span>)
<a name="l00074"></a>00074                     <a class="code" href="class_d_b_connector.html#43db9aca89fd7bf7ecd0643174246776">DBConnector::getDBConnector</a>()-&gt;executeQuery($query);
<a name="l00075"></a>00075             }
<a name="l00076"></a>00076         }
<a name="l00077"></a>00077         
<a name="l00078"></a>00078         <span class="keywordflow">if</span>(count(<a class="code" href="class_d_b_config.html#c27b363e32cdb69643d9cbf29e3e6a9b">DBConfig::getRecords</a>(<span class="stringliteral">"APPARITION RECHERCHE MENU DEROULANT"</span>)) == 0)
<a name="l00079"></a>00079             <a class="code" href="class_d_b_config.html#fa0db62ca7fa81d05c8a0f17be733be7">DBConfig::createRecord</a>(<span class="stringliteral">"APPARITION RECHERCHE MENU DEROULANT"</span>, 10);
<a name="l00080"></a>00080         <span class="keywordflow">if</span>(count(<a class="code" href="class_d_b_config.html#c27b363e32cdb69643d9cbf29e3e6a9b">DBConfig::getRecords</a>(<span class="stringliteral">"MAIL ADMINISTRATEURS"</span>)) == 0)
<a name="l00081"></a>00081             <a class="code" href="class_d_b_config.html#fa0db62ca7fa81d05c8a0f17be733be7">DBConfig::createRecord</a>(<span class="stringliteral">"MAIL ADMINISTRATEURS"</span>, <span class="stringliteral">"miage@adacis.net, olivier.marchand25@wanadoo.fr"</span>);
<a name="l00082"></a>00082         <span class="keywordflow">if</span>(count(<a class="code" href="class_d_b_config.html#c27b363e32cdb69643d9cbf29e3e6a9b">DBConfig::getRecords</a>(<span class="stringliteral">"MAIL SECRETARIAT"</span>)) == 0)
<a name="l00083"></a>00083             <a class="code" href="class_d_b_config.html#fa0db62ca7fa81d05c8a0f17be733be7">DBConfig::createRecord</a>(<span class="stringliteral">"MAIL SECRETARIAT"</span>, <span class="stringliteral">"sophie.espinosa@labri.fr"</span>);
<a name="l00084"></a>00084         <span class="keywordflow">if</span>(count(<a class="code" href="class_d_b_config.html#c27b363e32cdb69643d9cbf29e3e6a9b">DBConfig::getRecords</a>(<span class="stringliteral">"LOGIN ADMIN"</span>)) == 0)
<a name="l00085"></a>00085             <a class="code" href="class_d_b_config.html#fa0db62ca7fa81d05c8a0f17be733be7">DBConfig::createRecord</a>(<span class="stringliteral">"LOGIN ADMIN"</span>, <span class="stringliteral">"admin"</span>);
<a name="l00086"></a>00086         <span class="keywordflow">if</span>(count(<a class="code" href="class_d_b_config.html#c27b363e32cdb69643d9cbf29e3e6a9b">DBConfig::getRecords</a>(<span class="stringliteral">"PASSWORD ADMIN"</span>)) == 0)
<a name="l00087"></a>00087                 <a class="code" href="class_d_b_config.html#fa0db62ca7fa81d05c8a0f17be733be7">DBConfig::createRecord</a>(<span class="stringliteral">"PASSWORD ADMIN"</span>, md5(<span class="stringliteral">"admin"</span>));
<a name="l00088"></a>00088         <span class="keywordflow">if</span>(count(<a class="code" href="class_d_b_config.html#c27b363e32cdb69643d9cbf29e3e6a9b">DBConfig::getRecords</a>(<span class="stringliteral">"LOGIN SECRETAIRE"</span>)) == 0)
<a name="l00089"></a>00089             <a class="code" href="class_d_b_config.html#fa0db62ca7fa81d05c8a0f17be733be7">DBConfig::createRecord</a>(<span class="stringliteral">"LOGIN SECRETAIRE"</span>, <span class="stringliteral">"secretaire"</span>);
<a name="l00090"></a>00090         <span class="keywordflow">if</span>(count(<a class="code" href="class_d_b_config.html#c27b363e32cdb69643d9cbf29e3e6a9b">DBConfig::getRecords</a>(<span class="stringliteral">"PASSWORD SECRETAIRE"</span>)) == 0)
<a name="l00091"></a>00091                 <a class="code" href="class_d_b_config.html#fa0db62ca7fa81d05c8a0f17be733be7">DBConfig::createRecord</a>(<span class="stringliteral">"PASSWORD SECRETAIRE"</span>, md5(<span class="stringliteral">"secretaire"</span>));
<a name="l00092"></a>00092         <span class="keywordflow">if</span>(count(<a class="code" href="class_d_b_config.html#c27b363e32cdb69643d9cbf29e3e6a9b">DBConfig::getRecords</a>(<span class="stringliteral">"MAIL DEBUG"</span>)) == 0)
<a name="l00093"></a>00093             <a class="code" href="class_d_b_config.html#fa0db62ca7fa81d05c8a0f17be733be7">DBConfig::createRecord</a>(<span class="stringliteral">"MAIL DEBUG"</span>, <span class="stringliteral">"0"</span>);
<a name="l00094"></a>00094         <span class="keywordflow">if</span>(count(<a class="code" href="class_d_b_config.html#c27b363e32cdb69643d9cbf29e3e6a9b">DBConfig::getRecords</a>(<span class="stringliteral">"FONCTION"</span>)) == 0)
<a name="l00095"></a>00095             <a class="code" href="class_d_b_config.html#fa0db62ca7fa81d05c8a0f17be733be7">DBConfig::createRecord</a>(<span class="stringliteral">"FONCTION"</span>, <span class="stringliteral">"Directeur;;Chef de Projet;;Directeur Informatique;;DRH"</span>);
<a name="l00096"></a>00096         <span class="keywordflow">if</span>(count(<a class="code" href="class_d_b_config.html#c27b363e32cdb69643d9cbf29e3e6a9b">DBConfig::getRecords</a>(<span class="stringliteral">"DOMAINE"</span>)) == 0)
<a name="l00097"></a>00097             <a class="code" href="class_d_b_config.html#fa0db62ca7fa81d05c8a0f17be733be7">DBConfig::createRecord</a>(<span class="stringliteral">"DOMAINE"</span>, <span class="stringliteral">"Banque - Assurance;;Comptabilité;;Industrie;;Informatique;;Réseaux;;Secteur Public"</span>);
<a name="l00098"></a>00098         <span class="keywordflow">if</span>(count(<a class="code" href="class_d_b_config.html#c27b363e32cdb69643d9cbf29e3e6a9b">DBConfig::getRecords</a>(<span class="stringliteral">"TECHNOLOGIE"</span>)) == 0)
<a name="l00099"></a>00099             <a class="code" href="class_d_b_config.html#fa0db62ca7fa81d05c8a0f17be733be7">DBConfig::createRecord</a>(<span class="stringliteral">"TECHNOLOGIE"</span>, <span class="stringliteral">"C;;C++;;C#;;Java;;J2EE;;PHP;;SQL/PLSQL;;Oracle;;XML/XSLT;;ABAP"</span>);
<a name="l00100"></a>00100         <span class="keywordflow">if</span>(count(<a class="code" href="class_d_b_config.html#c27b363e32cdb69643d9cbf29e3e6a9b">DBConfig::getRecords</a>(<span class="stringliteral">"ANNEE PROMO"</span>)) == 0)
<a name="l00101"></a>00101             <a class="code" href="class_d_b_config.html#fa0db62ca7fa81d05c8a0f17be733be7">DBConfig::createRecord</a>(<span class="stringliteral">"ANNEE PROMO"</span>, <span class="stringliteral">"2005"</span>);
<a name="l00102"></a>00102         <span class="keywordflow">if</span>(count(<a class="code" href="class_d_b_config.html#c27b363e32cdb69643d9cbf29e3e6a9b">DBConfig::getRecords</a>(<span class="stringliteral">"PERMANENCES"</span>)) == 0)
<a name="l00103"></a>00103             <a class="code" href="class_d_b_config.html#fa0db62ca7fa81d05c8a0f17be733be7">DBConfig::createRecord</a>(<span class="stringliteral">"PERMANENCES"</span>, <span class="stringliteral">"Olivier Marchand : Le Vendredi, sur RDV\nChristophe Maillet : Lundi &amp; Vendredi sur RDV"</span>);
<a name="l00104"></a>00104         <span class="keywordflow">if</span>(count(<a class="code" href="class_d_b_config.html#c27b363e32cdb69643d9cbf29e3e6a9b">DBConfig::getRecords</a>(<span class="stringliteral">"TYPE ENTREPRISE"</span>)) == 0)
<a name="l00105"></a>00105             <a class="code" href="class_d_b_config.html#fa0db62ca7fa81d05c8a0f17be733be7">DBConfig::createRecord</a>(<span class="stringliteral">"TYPE ENTREPRISE"</span>,
<a name="l00106"></a>00106                                    <span class="stringliteral">"Administration;;Aéronautique;;Agence de communication;;Agence Internet;;Agroalimentaire;;"</span>
<a name="l00107"></a>00107                                                                   .<span class="stringliteral">"Association;;Assurances;;Banques;;Cabinet conseil systèmes d'information;;Cabinet d'expertise comptable;;"</span>
<a name="l00108"></a>00108                                                                   .<span class="stringliteral">"Caisse des depots;;Concessions automobiles;;Editeur de logiciels;;Entreprise Informatique;;Finance;;"</span>
<a name="l00109"></a>00109                                                                   .<span class="stringliteral">"Industrie;;Institut de recherches;;Presse;;Société de services;;Société de transport;;SSII;;Université"</span>);
<a name="l00110"></a>00110         <span class="keywordflow">if</span>(count(<a class="code" href="class_d_b_config.html#c27b363e32cdb69643d9cbf29e3e6a9b">DBConfig::getRecords</a>(<span class="stringliteral">"LIMITE SECONDES ENVOI MAIL"</span>)) == 0)
<a name="l00111"></a>00111             <a class="code" href="class_d_b_config.html#fa0db62ca7fa81d05c8a0f17be733be7">DBConfig::createRecord</a>(<span class="stringliteral">"LIMITE SECONDES ENVOI MAIL"</span>, <span class="stringliteral">"3600"</span>);
<a name="l00112"></a>00112     }
<a name="l00113"></a>00113     
<a name="l00121"></a><a class="code" href="class_d_b_config.html#fa0db62ca7fa81d05c8a0f17be733be7">00121</a>         <span class="keyword">public</span> <span class="keyword">static</span> function <a class="code" href="class_d_b_config.html#fa0db62ca7fa81d05c8a0f17be733be7">createRecord</a>($nomVariable, $valeurVariable){
<a name="l00122"></a>00122         $sql = <span class="stringliteral">"INSERT INTO "</span>.DBConfig::$TABLE_NAME.<span class="stringliteral">" ("</span>
<a name="l00123"></a>00123                             .DBConfig::$FIELD_NOM_VARIABLE.<span class="stringliteral">", "</span>
<a name="l00124"></a>00124                             .DBConfig::$FIELD_VALEUR_VARIABLE.<span class="stringliteral">" "</span>
<a name="l00125"></a>00125                             .<span class="stringliteral">") VALUES ("</span>
<a name="l00126"></a>00126                             .DBConnector::getDBConnector()-&gt;processString(<a class="code" href="class_d_b_connector.html#43db9aca89fd7bf7ecd0643174246776">DBConnector::getDBConnector</a>()-&gt;echapString($nomVariable)).<span class="stringliteral">", "</span>
<a name="l00127"></a>00127                             .DBConnector::getDBConnector()-&gt;processString(<a class="code" href="class_d_b_connector.html#43db9aca89fd7bf7ecd0643174246776">DBConnector::getDBConnector</a>()-&gt;echapString($valeurVariable)).<span class="stringliteral">" "</span>
<a name="l00128"></a>00128                             .<span class="stringliteral">")"</span>;
<a name="l00129"></a>00129         
<a name="l00130"></a>00130         $id = <a class="code" href="class_d_b_connector.html#43db9aca89fd7bf7ecd0643174246776">DBConnector::getDBConnector</a>()-&gt;executeQuery($sql);
<a name="l00131"></a>00131         
<a name="l00132"></a>00132         $obj = <a class="code" href="class_d_b_config.html#c27b363e32cdb69643d9cbf29e3e6a9b">DBConfig::getRecords</a>($nomVariable, $valeurVariable);
<a name="l00133"></a>00133         assert(count($obj) == 1);
<a name="l00134"></a>00134         <span class="keywordflow">return</span> $obj[0];
<a name="l00135"></a>00135     }
<a name="l00136"></a>00136     
<a name="l00144"></a><a class="code" href="class_d_b_config.html#c27b363e32cdb69643d9cbf29e3e6a9b">00144</a>         <span class="keyword">public</span> <span class="keyword">static</span> function <a class="code" href="class_d_b_config.html#c27b363e32cdb69643d9cbf29e3e6a9b">getRecords</a>($nomVariable=<span class="stringliteral">""</span>, $valeurVariable=<span class="stringliteral">""</span>){
<a name="l00145"></a>00145         $sql = <span class="stringliteral">"SELECT * FROM "</span>.DBConfig::$TABLE_NAME.<span class="stringliteral">" WHERE 1"</span>;
<a name="l00146"></a>00146         
<a name="l00147"></a>00147         <span class="keywordflow">if</span>($nomVariable != <span class="stringliteral">""</span>)
<a name="l00148"></a>00148             $sql .= <span class="stringliteral">" AND "</span>.DBConfig::$FIELD_NOM_VARIABLE.<span class="stringliteral">"="</span>.<a class="code" href="class_d_b_connector.html#43db9aca89fd7bf7ecd0643174246776">DBConnector::getDBConnector</a>()-&gt;processString(<a class="code" href="class_d_b_connector.html#43db9aca89fd7bf7ecd0643174246776">DBConnector::getDBConnector</a>()-&gt;echapString($nomVariable));
<a name="l00149"></a>00149         <span class="keywordflow">if</span>($valeurVariable != <span class="stringliteral">""</span>)
<a name="l00150"></a>00150             $sql .= <span class="stringliteral">" AND "</span>.DBConfig::$FIELD_VALEUR_VARIABLE.<span class="stringliteral">"="</span>.<a class="code" href="class_d_b_connector.html#43db9aca89fd7bf7ecd0643174246776">DBConnector::getDBConnector</a>()-&gt;processString(<a class="code" href="class_d_b_connector.html#43db9aca89fd7bf7ecd0643174246776">DBConnector::getDBConnector</a>()-&gt;echapString($valeurVariable));
<a name="l00151"></a>00151         
<a name="l00152"></a>00152         $res = <a class="code" href="class_d_b_connector.html#43db9aca89fd7bf7ecd0643174246776">DBConnector::getDBConnector</a>()-&gt;executeQuery($sql);
<a name="l00153"></a>00153         
<a name="l00154"></a>00154         $return = array();
<a name="l00155"></a>00155         $i=0;
<a name="l00156"></a>00156         <span class="keywordflow">while</span>($result = <a class="code" href="class_d_b_connector.html#43db9aca89fd7bf7ecd0643174246776">DBConnector::getDBConnector</a>()-&gt;fetchArray($res))
<a name="l00157"></a>00157         {
<a name="l00158"></a>00158             $return[$i] = <span class="keyword">new</span> <a class="code" href="class_d_b_config.html">DBConfig</a>(
<a name="l00159"></a>00159                                             $result[<a class="code" href="class_d_b_config.html#190da17a1066fe90a91e999a7135dd51">DBConfig::$FIELD_NOM_VARIABLE</a>],
<a name="l00160"></a>00160                                             $result[<a class="code" href="class_d_b_config.html#82636376c149716f62919659cf921576">DBConfig::$FIELD_VALEUR_VARIABLE</a>]
<a name="l00161"></a>00161                                         );
<a name="l00162"></a>00162             
<a name="l00163"></a>00163             $i++;
<a name="l00164"></a>00164         }
<a name="l00165"></a>00165         
<a name="l00166"></a>00166         <span class="keywordflow">return</span> $return;
<a name="l00167"></a>00167     }
<a name="l00168"></a>00168     
<a name="l00175"></a><a class="code" href="class_d_b_config.html#502de2ce25da7420344ecde589256941">00175</a>         <span class="keyword">public</span> <span class="keyword">static</span> function <a class="code" href="class_d_b_config.html#502de2ce25da7420344ecde589256941">updateRecord</a>($nomVariable, $valeurVariable){
<a name="l00176"></a>00176         $sql = <span class="stringliteral">"UPDATE "</span>.DBConfig::$TABLE_NAME.<span class="stringliteral">" SET "</span>;
<a name="l00177"></a>00177         $sql .= <a class="code" href="class_d_b_config.html#82636376c149716f62919659cf921576">DBConfig::$FIELD_VALEUR_VARIABLE</a>.<span class="stringliteral">"="</span>.<a class="code" href="class_d_b_connector.html#43db9aca89fd7bf7ecd0643174246776">DBConnector::getDBConnector</a>()-&gt;processString(<a class="code" href="class_d_b_connector.html#43db9aca89fd7bf7ecd0643174246776">DBConnector::getDBConnector</a>()-&gt;echapString($valeurVariable)).<span class="stringliteral">""</span>;
<a name="l00178"></a>00178         
<a name="l00179"></a>00179         $sql .= <span class="stringliteral">" WHERE 1"</span>;
<a name="l00180"></a>00180         $sql .= <span class="stringliteral">" AND "</span>.DBConfig::$FIELD_NOM_VARIABLE.<span class="stringliteral">"="</span>.<a class="code" href="class_d_b_connector.html#43db9aca89fd7bf7ecd0643174246776">DBConnector::getDBConnector</a>()-&gt;processString(<a class="code" href="class_d_b_connector.html#43db9aca89fd7bf7ecd0643174246776">DBConnector::getDBConnector</a>()-&gt;echapString($nomVariable));
<a name="l00181"></a>00181         
<a name="l00182"></a>00182         <a class="code" href="class_d_b_connector.html#43db9aca89fd7bf7ecd0643174246776">DBConnector::getDBConnector</a>()-&gt;executeQuery($sql);
<a name="l00183"></a>00183     }
<a name="l00184"></a>00184         
<a name="l00189"></a><a class="code" href="class_d_b_config.html#fd0c58b014c8f0e902f19a34925181d2">00189</a>     <span class="keyword">public</span>  function <a class="code" href="class_d_b_config.html#fd0c58b014c8f0e902f19a34925181d2">deleteRecord</a>(){
<a name="l00190"></a>00190         $sql = <span class="stringliteral">"DELETE FROM "</span>.DBConfig::$TABLE_NAME.<span class="stringliteral">" WHERE 1"</span>;
<a name="l00191"></a>00191         $sql .= <span class="stringliteral">" AND "</span>.DBConfig::$FIELD_NOM_VARIABLE.<span class="stringliteral">"="</span>.<a class="code" href="class_d_b_connector.html#43db9aca89fd7bf7ecd0643174246776">DBConnector::getDBConnector</a>()-&gt;processString(<a class="code" href="class_d_b_connector.html#43db9aca89fd7bf7ecd0643174246776">DBConnector::getDBConnector</a>()-&gt;echapString($this-&gt;_nomVariable));
<a name="l00192"></a>00192         
<a name="l00193"></a>00193         <a class="code" href="class_d_b_connector.html#43db9aca89fd7bf7ecd0643174246776">DBConnector::getDBConnector</a>()-&gt;executeQuery($sql);
<a name="l00194"></a>00194     }
<a name="l00195"></a>00195         
<a name="l00196"></a>00196         
<a name="l00203"></a><a class="code" href="class_d_b_config.html#7e66dfa5143f057ff66c73cbbe3eeb65">00203</a>     <span class="keyword">public</span> <span class="keyword">static</span> function <a class="code" href="class_d_b_config.html#7e66dfa5143f057ff66c73cbbe3eeb65">getConfigValue</a>($variableName){
<a name="l00204"></a>00204         $configs = <a class="code" href="class_d_b_config.html#c27b363e32cdb69643d9cbf29e3e6a9b">DBConfig::getRecords</a>($variableName);
<a name="l00205"></a>00205         <span class="keywordflow">if</span>(count($configs) != 1) die(<span class="stringliteral">"Erreur : DBConfig::getConfigValue($variableName) : $variableName inconnue dans la table de configuration !!"</span>);
<a name="l00206"></a>00206         $c = $configs[0];
<a name="l00207"></a>00207         <span class="keywordflow">return</span> $c-&gt;getValeurVariable();
<a name="l00208"></a>00208     }
<a name="l00209"></a>00209         
<a name="l00217"></a><a class="code" href="class_d_b_config.html#8c73906f5d13863f42c2c0ecb783e0c6">00217</a>     <span class="keyword">public</span> <span class="keyword">static</span> function <a class="code" href="class_d_b_config.html#8c73906f5d13863f42c2c0ecb783e0c6">authAdmin</a>($login, $mdp){
<a name="l00218"></a>00218         $log = <a class="code" href="class_d_b_config.html#c27b363e32cdb69643d9cbf29e3e6a9b">DBConfig::getRecords</a>(<span class="stringliteral">"LOGIN ADMIN"</span>, $login);
<a name="l00219"></a>00219         $pass = <a class="code" href="class_d_b_config.html#c27b363e32cdb69643d9cbf29e3e6a9b">DBConfig::getRecords</a>(<span class="stringliteral">"PASSWORD ADMIN"</span>, md5($mdp));
<a name="l00220"></a>00220         <span class="keywordflow">if</span> ((count($log)==1) and (count($pass)==1))
<a name="l00221"></a>00221                 <span class="keywordflow">return</span> $log[0]-&gt;getValeurVariable();
<a name="l00222"></a>00222         <span class="keywordflow">else</span>
<a name="l00223"></a>00223                 <span class="keywordflow">return</span> NULL;
<a name="l00224"></a>00224     }
<a name="l00225"></a>00225     
<a name="l00233"></a><a class="code" href="class_d_b_config.html#30685a5ff31eaf383629cd4968527eac">00233</a>     <span class="keyword">public</span> <span class="keyword">static</span> function <a class="code" href="class_d_b_config.html#30685a5ff31eaf383629cd4968527eac">authSecretaire</a>($login, $mdp){
<a name="l00234"></a>00234         $log = <a class="code" href="class_d_b_config.html#c27b363e32cdb69643d9cbf29e3e6a9b">DBConfig::getRecords</a>(<span class="stringliteral">"LOGIN SECRETAIRE"</span>, $login);
<a name="l00235"></a>00235         $pass = <a class="code" href="class_d_b_config.html#c27b363e32cdb69643d9cbf29e3e6a9b">DBConfig::getRecords</a>(<span class="stringliteral">"PASSWORD SECRETAIRE"</span>, md5($mdp));
<a name="l00236"></a>00236         <span class="keywordflow">if</span> ((count($log)==1) and (count($pass)==1))
<a name="l00237"></a>00237                 <span class="keywordflow">return</span> $log[0]-&gt;getValeurVariable();
<a name="l00238"></a>00238         <span class="keywordflow">else</span>
<a name="l00239"></a>00239                 <span class="keywordflow">return</span> NULL;
<a name="l00240"></a>00240     }
<a name="l00241"></a>00241     
<a name="l00249"></a><a class="code" href="class_d_b_config.html#f2599f2c9b0660e95d8fcbf3cfe51e46">00249</a>     <span class="keyword">public</span> <span class="keyword">static</span> function <a class="code" href="class_d_b_config.html#f2599f2c9b0660e95d8fcbf3cfe51e46">getEnumeration</a>($enumeratedVariable,$addAutre=<span class="keyword">true</span>){
<a name="l00250"></a>00250         $table = <a class="code" href="class_enumeration.html#1df8ad6db312c15001bf428f5508cd47">Enumeration::getSelectablesArray</a>(explode(<span class="stringliteral">";;"</span>, <a class="code" href="class_d_b_config.html#7e66dfa5143f057ff66c73cbbe3eeb65">DBConfig::getConfigValue</a>($enumeratedVariable)), <span class="keyword">true</span>);
<a name="l00251"></a>00251         $table = <a class="code" href="class_enumeration.html#31dd2e15f6429c7a960371d303f172e6">Enumeration::sort</a>($table,'$a-&gt;getFormSelectOptionLabel()');
<a name="l00252"></a>00252         <span class="keywordflow">if</span> ($addAutre){
<a name="l00253"></a>00253                 $table[count($table)] = <span class="keyword">new</span> <a class="code" href="class_enumerable.html">Enumerable</a>(<span class="stringliteral">"Autre"</span>,<span class="stringliteral">"Autre"</span>);}
<a name="l00254"></a>00254         <span class="keywordflow">return</span> $table;
<a name="l00255"></a>00255     }
<a name="l00256"></a>00256     
<a name="l00263"></a><a class="code" href="class_d_b_config.html#a0e278bf458371b1930b1aad6411a3a8">00263</a>     <span class="keyword">public</span> <span class="keyword">static</span> function <a class="code" href="class_d_b_config.html#a0e278bf458371b1930b1aad6411a3a8">isTypeEntreprise</a>($valueType){
<a name="l00264"></a>00264         $liste = <a class="code" href="class_d_b_config.html#f2599f2c9b0660e95d8fcbf3cfe51e46">DBConfig::getEnumeration</a>(<span class="stringliteral">"TYPE ENTREPRISE"</span>);
<a name="l00265"></a>00265         foreach ($liste as $type){
<a name="l00266"></a>00266                 <span class="keywordflow">if</span> ($type-&gt;getFormSelectOptionValue()==$valueType){
<a name="l00267"></a>00267                         <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00268"></a>00268                 }
<a name="l00269"></a>00269         }
<a name="l00270"></a>00270         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00271"></a>00271     }
<a name="l00272"></a>00272     
<a name="l00280"></a><a class="code" href="class_d_b_config.html#8f6fc8d19f7fe23769b30ffdbf250daf">00280</a>     <span class="keyword">public</span> <span class="keyword">static</span> function <a class="code" href="class_d_b_config.html#8f6fc8d19f7fe23769b30ffdbf250daf">inEnumeration</a>($nom_enum,$valueType){
<a name="l00281"></a>00281                 $liste = <a class="code" href="class_d_b_config.html#f2599f2c9b0660e95d8fcbf3cfe51e46">DBConfig::getEnumeration</a>($nom_enum);
<a name="l00282"></a>00282                 foreach ($liste as $type){
<a name="l00283"></a>00283                         <span class="keywordflow">if</span> ($type-&gt;getFormSelectOptionValue()==$valueType){
<a name="l00284"></a>00284                                 <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00285"></a>00285                         }
<a name="l00286"></a>00286                 }
<a name="l00287"></a>00287                 <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00288"></a>00288     }
<a name="l00289"></a>00289     
<a name="l00296"></a><a class="code" href="class_d_b_config.html#1b2ffcf5d1df4bbfc26ffb617fb41c72">00296</a>     <span class="keyword">public</span> <span class="keyword">static</span> function <a class="code" href="class_d_b_config.html#1b2ffcf5d1df4bbfc26ffb617fb41c72">validPasswordAdmin</a>($value){
<a name="l00297"></a>00297         $passwd = <a class="code" href="class_d_b_config.html#7e66dfa5143f057ff66c73cbbe3eeb65">DBConfig::getConfigValue</a>(<span class="stringliteral">"PASSWORD ADMIN"</span>);
<a name="l00298"></a>00298         <span class="keywordflow">return</span> md5($value)==$passwd;
<a name="l00299"></a>00299     }
<a name="l00300"></a>00300         
<a name="l00301"></a>00301                 
<a name="l00308"></a><a class="code" href="class_d_b_config.html#e8c5b7e22698a1c981f9d84b8f210ee7">00308</a>     <span class="keyword">public</span> <span class="keyword">static</span> function <a class="code" href="class_d_b_config.html#e8c5b7e22698a1c981f9d84b8f210ee7">validPasswordSecretaire</a>($value){
<a name="l00309"></a>00309         $passwd = <a class="code" href="class_d_b_config.html#7e66dfa5143f057ff66c73cbbe3eeb65">DBConfig::getConfigValue</a>(<span class="stringliteral">"PASSWORD SECRETAIRE"</span>);
<a name="l00310"></a>00310         <span class="keywordflow">return</span> md5($value)==$passwd;
<a name="l00311"></a>00311     }
<a name="l00312"></a>00312 }
<a name="l00313"></a>00313 ?&gt;
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Wed Mar 28 11:48:05 2007 for Stage by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.1-p1 </small></address>
</body>
</html>
