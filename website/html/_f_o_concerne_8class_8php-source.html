<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>Stage: D:/developpement/php/www/Stage/trunk/class/FormObjects/FOConcerne.class.php Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.1-p1 -->
<div class="tabs">
  <ul>
    <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
    <li><a href="namespaces.html"><span>Namespaces</span></a></li>
    <li><a href="annotated.html"><span>Classes</span></a></li>
    <li id="current"><a href="files.html"><span>Files</span></a></li>
    <li>
      <form action="search.php" method="get">
        <table cellspacing="0" cellpadding="0" border="0">
          <tr>
            <td><label>&nbsp;<u>S</u>earch&nbsp;for&nbsp;</label></td>
            <td><input type="text" name="query" value="" size="20" accesskey="s"/></td>
          </tr>
        </table>
      </form>
    </li>
  </ul></div>
<h1>D:/developpement/php/www/Stage/trunk/class/FormObjects/FOConcerne.class.php</h1><a href="_f_o_concerne_8class_8php.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 &lt;?php
<a name="l00002"></a>00002 set_include_path(<span class="stringliteral">"."</span>.PATH_SEPARATOR.<span class="stringliteral">".."</span>);
<a name="l00003"></a>00003 require_once(<span class="stringliteral">"inc/main.inc.php"</span>);
<a name="l00010"></a><a class="code" href="class_f_o_concerne.html">00010</a> <span class="keyword">class </span><a class="code" href="class_f_o_concerne.html">FOConcerne</a> <span class="keyword">extends</span> <a class="code" href="class_form_object.html">FormObject</a>{
<a name="l00011"></a><a class="code" href="class_f_o_concerne.html#054b38bd875fc4574553b11a06481dcd">00011</a>     <span class="keyword">public</span> <span class="keyword">static</span> <a class="code" href="class_f_o_concerne.html#054b38bd875fc4574553b11a06481dcd">$CHAMP_FORM_ID_TYPE_STAGE</a> = <span class="stringliteral">"id_type_stage"</span>;
<a name="l00012"></a><a class="code" href="class_f_o_concerne.html#6e6a7fe2bfa49343a77d81d68974289a">00012</a>     <span class="keyword">public</span> <span class="keyword">static</span> <a class="code" href="class_f_o_concerne.html#6e6a7fe2bfa49343a77d81d68974289a">$CHAMP_FORM_ID_PROPOSITION_STAGE</a> = <span class="stringliteral">"id_proposition_stage"</span>;
<a name="l00013"></a>00013 
<a name="l00014"></a><a class="code" href="class_f_o_concerne.html#b24b1b8ea6fc265d9ee6d2024d776cac">00014</a>     <span class="keyword">protected</span> <a class="code" href="class_f_o_concerne.html#b24b1b8ea6fc265d9ee6d2024d776cac">$_idsTypesStage</a>;
<a name="l00015"></a><a class="code" href="class_f_o_concerne.html#142fbbfa002c00c6069657ac494a7ad1">00015</a>     <span class="keyword">protected</span> <a class="code" href="class_f_o_concerne.html#142fbbfa002c00c6069657ac494a7ad1">$_idPropStage</a>;
<a name="l00016"></a>00016         
<a name="l00022"></a><a class="code" href="class_f_o_concerne.html#1c76259b7b79e57c19caa6d4a5fa0f20">00022</a>     <span class="keyword">public</span> function <a class="code" href="class_f_o_concerne.html#1c76259b7b79e57c19caa6d4a5fa0f20">init</a>(){
<a name="l00023"></a>00023         $typesStage = <a class="code" href="class_d_b_type_stage.html#83fd19172ee91023b7cbb7a2990a0163">DBTypeStage::getRecords</a>();
<a name="l00024"></a>00024         $listeTypeStage=array();
<a name="l00025"></a>00025         foreach($typesStage as $typeStage)
<a name="l00026"></a>00026             <span class="keywordflow">if</span>((isset($_POST[<a class="code" href="class_f_o_concerne.html#054b38bd875fc4574553b11a06481dcd">FOConcerne::$CHAMP_FORM_ID_TYPE_STAGE</a>.<span class="stringliteral">"__"</span>.$typeStage-&gt;getIdTypeStage()])?$_POST[<a class="code" href="class_f_o_concerne.html#054b38bd875fc4574553b11a06481dcd">FOConcerne::$CHAMP_FORM_ID_TYPE_STAGE</a>.<span class="stringliteral">"__"</span>.$typeStage-&gt;getIdTypeStage()]:0))
<a name="l00027"></a>00027                 $listeTypeStage[count($listeTypeStage)]=$typeStage-&gt;getIdTypeStage();
<a name="l00028"></a>00028 
<a name="l00029"></a>00029         $this-&gt;_idsTypesStage =$listeTypeStage;
<a name="l00030"></a>00030     }
<a name="l00036"></a><a class="code" href="class_f_o_concerne.html#6fc4fcca058671fefc3cd684ea41878e">00036</a>     <span class="keyword">public</span> function <a class="code" href="class_f_o_concerne.html#6fc4fcca058671fefc3cd684ea41878e">isValid</a>(){
<a name="l00037"></a>00037         <span class="keywordflow">if</span>(count($this-&gt;_idsTypesStage)==0)
<a name="l00038"></a>00038               $this-&gt;<a class="code" href="class_form_object.html#970137f1701e6cc8c04116b0a8cc7b68">setErrorMessage</a>(<span class="stringliteral">"Erreur : aucun type de stage n'a été sélectionné !"</span>);
<a name="l00039"></a>00039         <span class="keywordflow">return</span> ($this-&gt;<a class="code" href="class_form_object.html#1d4e4d699dc23d76066344b477a5a728">getErrorMessage</a>() == <span class="stringliteral">""</span>);
<a name="l00040"></a>00040     }
<a name="l00041"></a>00041         
<a name="l00047"></a><a class="code" href="class_f_o_concerne.html#7148b4f3310810b631f5ea2690bd6404">00047</a>     <span class="keyword">public</span> function <a class="code" href="class_f_o_concerne.html#7148b4f3310810b631f5ea2690bd6404">process</a>(){
<a name="l00048"></a>00048         $propositionStage = $this-&gt;<a class="code" href="class_form_object.html#275d0f7388bd79ed50369b0c9dfbac74">getPostFormManager</a>()-&gt;getFormObjectResult(<span class="stringliteral">"Proposition stage"</span>);
<a name="l00049"></a>00049         <span class="keywordflow">for</span>($i=0;$i&lt;count($this-&gt;_idsTypesStage);$i++)
<a name="l00050"></a>00050         {
<a name="l00051"></a>00051             $typeStage=<a class="code" href="class_d_b_type_stage.html#83fd19172ee91023b7cbb7a2990a0163">DBTypeStage::getRecords</a>($this-&gt;_idsTypesStage[$i]);
<a name="l00052"></a>00052             assert(count($typeStage)==1);
<a name="l00053"></a>00053 
<a name="l00054"></a>00054             <a class="code" href="class_d_b_concerne.html#9c1212dc7fce9631d9f5c7165c19882d">DBConcerne::createRecord</a>($typeStage[0],$propositionStage);
<a name="l00055"></a>00055         }
<a name="l00056"></a>00056 
<a name="l00057"></a>00057         <span class="comment">// Mail à l'administrateur</span>
<a name="l00058"></a>00058         <span class="keywordflow">if</span>($propositionStage-&gt;notificationAdministrateurAjout())
<a name="l00059"></a>00059             $this-&gt;<a class="code" href="class_form_object.html#a2b21ba081368508faa4ab1538173fb5">setOKMessage</a>(<span class="stringliteral">"L'administrateur a été informé par mail de votre proposition. Cette dernière devra être validé pour être rendue disponible auprès des étudiants. Vous serez informé de cette validation ou, si un refus est effectué par l'administrateur, vous serez informé du motif du refus."</span>);
<a name="l00060"></a>00060         <span class="keywordflow">else</span>
<a name="l00061"></a>00061             $this-&gt;<a class="code" href="class_form_object.html#a2b21ba081368508faa4ab1538173fb5">setOKMessage</a>(<span class="stringliteral">"Erreur lors de l'envoi de mail à l'administrateur !"</span>);
<a name="l00062"></a>00062     }
<a name="l00063"></a>00063 }
<a name="l00064"></a>00064 ?&gt;
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Wed Mar 28 11:48:06 2007 for Stage by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.1-p1 </small></address>
</body>
</html>
